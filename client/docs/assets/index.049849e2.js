(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const ct={};function wr(a){ct.context=a}const br=(a,n)=>a===n,yr=Symbol("solid-track"),Mn={equals:br};let zs=to;const At=1,Bn=2,Xs={owned:null,cleanups:null,context:null,owner:null};var Se=null;let Ot=null,Ee=null,Re=null,wt=null,mi=0;function Sn(a,n){const t=Ee,s=Se,r=a.length===0,i=r?Xs:{owned:null,cleanups:null,context:null,owner:n||s},p=r?a:()=>a(()=>Ct(()=>qn(i)));Se=i,Ee=null;try{return an(p,!0)}finally{Ee=t,Se=s}}function W(a,n){n=n?Object.assign({},Mn,n):Mn;const t={value:a,observers:null,observerSlots:null,comparator:n.equals||void 0},s=r=>(typeof r=="function"&&(r=r(t.value)),eo(t,r));return[Zs.bind(t),s]}function dt(a,n,t){const s=vi(a,n,!1,At);ln(s)}function _r(a,n,t){zs=Tr;const s=vi(a,n,!1,At);s.user=!0,wt?wt.push(s):ln(s)}function tt(a,n,t){t=t?Object.assign({},Mn,t):Mn;const s=vi(a,n,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=t.equals||void 0,ln(s),Zs.bind(s)}function Ct(a){const n=Ee;Ee=null;try{return a()}finally{Ee=n}}function We(a){_r(()=>Ct(a))}function Js(a){return Se===null||(Se.cleanups===null?Se.cleanups=[a]:Se.cleanups.push(a)),a}function Pr(a,n){const t=Symbol("context");return{id:t,Provider:Ir(t),defaultValue:a}}function xr(a){let n;return(n=so(Se,a.id))!==void 0?n:a.defaultValue}function Ar(a){const n=tt(a),t=tt(()=>pi(n()));return t.toArray=()=>{const s=t();return Array.isArray(s)?s:s!=null?[s]:[]},t}function Zs(){const a=Ot;if(this.sources&&(this.state||a))if(this.state===At||a)ln(this);else{const n=Re;Re=null,an(()=>On(this),!1),Re=n}if(Ee){const n=this.observers?this.observers.length:0;Ee.sources?(Ee.sources.push(this),Ee.sourceSlots.push(n)):(Ee.sources=[this],Ee.sourceSlots=[n]),this.observers?(this.observers.push(Ee),this.observerSlots.push(Ee.sources.length-1)):(this.observers=[Ee],this.observerSlots=[Ee.sources.length-1])}return this.value}function eo(a,n,t){let s=a.value;return(!a.comparator||!a.comparator(s,n))&&(a.value=n,a.observers&&a.observers.length&&an(()=>{for(let r=0;r<a.observers.length;r+=1){const i=a.observers[r],p=Ot&&Ot.running;p&&Ot.disposed.has(i),(p&&!i.tState||!p&&!i.state)&&(i.pure?Re.push(i):wt.push(i),i.observers&&no(i)),p||(i.state=At)}if(Re.length>1e6)throw Re=[],new Error},!1)),n}function ln(a){if(!a.fn)return;qn(a);const n=Se,t=Ee,s=mi;Ee=Se=a,Cr(a,a.value,s),Ee=t,Se=n}function Cr(a,n,t){let s;try{s=a.fn(n)}catch(r){a.pure&&(a.state=At,a.owned&&a.owned.forEach(qn),a.owned=null),io(r)}(!a.updatedAt||a.updatedAt<=t)&&(a.updatedAt!=null&&"observers"in a?eo(a,s):a.value=s,a.updatedAt=t)}function vi(a,n,t,s=At,r){const i={fn:a,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:Se,context:null,pure:t};return Se===null||Se!==Xs&&(Se.owned?Se.owned.push(i):Se.owned=[i]),i}function Ln(a){const n=Ot;if(a.state===0||n)return;if(a.state===Bn||n)return On(a);if(a.suspense&&Ct(a.suspense.inFallback))return a.suspense.effects.push(a);const t=[a];for(;(a=a.owner)&&(!a.updatedAt||a.updatedAt<mi);)(a.state||n)&&t.push(a);for(let s=t.length-1;s>=0;s--)if(a=t[s],a.state===At||n)ln(a);else if(a.state===Bn||n){const r=Re;Re=null,an(()=>On(a,t[0]),!1),Re=r}}function an(a,n){if(Re)return a();let t=!1;n||(Re=[]),wt?t=!0:wt=[],mi++;try{const s=a();return kr(t),s}catch(s){Re||(wt=null),io(s)}}function kr(a){if(Re&&(to(Re),Re=null),a)return;const n=wt;wt=null,n.length&&an(()=>zs(n),!1)}function to(a){for(let n=0;n<a.length;n++)Ln(a[n])}function Tr(a){let n,t=0;for(n=0;n<a.length;n++){const s=a[n];s.user?a[t++]=s:Ln(s)}for(ct.context&&wr(),n=0;n<t;n++)Ln(a[n])}function On(a,n){const t=Ot;a.state=0;for(let s=0;s<a.sources.length;s+=1){const r=a.sources[s];r.sources&&(r.state===At||t?r!==n&&Ln(r):(r.state===Bn||t)&&On(r,n))}}function no(a){const n=Ot;for(let t=0;t<a.observers.length;t+=1){const s=a.observers[t];(!s.state||n)&&(s.state=Bn,s.pure?Re.push(s):wt.push(s),s.observers&&no(s))}}function qn(a){let n;if(a.sources)for(;a.sources.length;){const t=a.sources.pop(),s=a.sourceSlots.pop(),r=t.observers;if(r&&r.length){const i=r.pop(),p=t.observerSlots.pop();s<r.length&&(i.sourceSlots[p]=s,r[s]=i,t.observerSlots[s]=p)}}if(a.owned){for(n=0;n<a.owned.length;n++)qn(a.owned[n]);a.owned=null}if(a.cleanups){for(n=0;n<a.cleanups.length;n++)a.cleanups[n]();a.cleanups=null}a.state=0,a.context=null}function Er(a){return a instanceof Error||typeof a=="string"?a:new Error("Unknown error")}function io(a){throw a=Er(a),a}function so(a,n){return a?a.context&&a.context[n]!==void 0?a.context[n]:so(a.owner,n):void 0}function pi(a){if(typeof a=="function"&&!a.length)return pi(a());if(Array.isArray(a)){const n=[];for(let t=0;t<a.length;t++){const s=pi(a[t]);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return n}return a}function Ir(a,n){return function(s){let r;return dt(()=>r=Ct(()=>(Se.context={[a]:s.value},Ar(()=>s.children))),void 0),r}}const Sr=Symbol("fallback");function js(a){for(let n=0;n<a.length;n++)a[n]()}function Vr(a,n,t={}){let s=[],r=[],i=[],p=0,c=n.length>1?[]:null;return Js(()=>js(i)),()=>{let u=a()||[],b,w;return u[yr],Ct(()=>{let D=u.length,x,C,E,L,M,N,F,O,se;if(D===0)p!==0&&(js(i),i=[],s=[],r=[],p=0,c&&(c=[])),t.fallback&&(s=[Sr],r[0]=Sn(R=>(i[0]=R,t.fallback())),p=1);else if(p===0){for(r=new Array(D),w=0;w<D;w++)s[w]=u[w],r[w]=Sn(j);p=D}else{for(E=new Array(D),L=new Array(D),c&&(M=new Array(D)),N=0,F=Math.min(p,D);N<F&&s[N]===u[N];N++);for(F=p-1,O=D-1;F>=N&&O>=N&&s[F]===u[O];F--,O--)E[O]=r[F],L[O]=i[F],c&&(M[O]=c[F]);for(x=new Map,C=new Array(O+1),w=O;w>=N;w--)se=u[w],b=x.get(se),C[w]=b===void 0?-1:b,x.set(se,w);for(b=N;b<=F;b++)se=s[b],w=x.get(se),w!==void 0&&w!==-1?(E[w]=r[b],L[w]=i[b],c&&(M[w]=c[b]),w=C[w],x.set(se,w)):i[b]();for(w=N;w<D;w++)w in E?(r[w]=E[w],i[w]=L[w],c&&(c[w]=M[w],c[w](w))):r[w]=Sn(j);r=r.slice(0,p=D),s=u.slice(0)}return r});function j(D){if(i[w]=D,c){const[x,C]=W(w);return c[w]=C,n(u[w],x)}return n(u[w])}}}function G(a,n){return Ct(()=>a(n||{}))}function $n(a){const n="fallback"in a&&{fallback:()=>a.fallback};return tt(Vr(()=>a.each,a.children,n||void 0))}function De(a){let n=!1;const t=a.keyed,s=tt(()=>a.when,void 0,{equals:(r,i)=>n?r===i:!r==!i});return tt(()=>{const r=s();if(r){const i=a.children,p=typeof i=="function"&&i.length>0;return n=t||p,p?Ct(()=>i(r)):i}return a.fallback},void 0,void 0)}function Mr(a,n,t){let s=t.length,r=n.length,i=s,p=0,c=0,u=n[r-1].nextSibling,b=null;for(;p<r||c<i;){if(n[p]===t[c]){p++,c++;continue}for(;n[r-1]===t[i-1];)r--,i--;if(r===p){const w=i<s?c?t[c-1].nextSibling:t[i-c]:u;for(;c<i;)a.insertBefore(t[c++],w)}else if(i===c)for(;p<r;)(!b||!b.has(n[p]))&&n[p].remove(),p++;else if(n[p]===t[i-1]&&t[c]===n[r-1]){const w=n[--r].nextSibling;a.insertBefore(t[c++],n[p++].nextSibling),a.insertBefore(t[--i],w),n[r]=t[i]}else{if(!b){b=new Map;let j=c;for(;j<i;)b.set(t[j],j++)}const w=b.get(n[p]);if(w!=null)if(c<w&&w<i){let j=p,D=1,x;for(;++j<r&&j<i&&!((x=b.get(n[j]))==null||x!==w+D);)D++;if(D>w-c){const C=n[p];for(;c<w;)a.insertBefore(t[c++],C)}else a.replaceChild(t[c++],n[p++])}else p++;else n[p++].remove()}}}const Us="_$DX_DELEGATE";function Br(a,n,t,s={}){let r;return Sn(i=>{r=i,n===document?a():Ae(n,a(),n.firstChild?null:void 0,t)},s.owner),()=>{r(),n.textContent=""}}function ke(a,n,t){const s=document.createElement("template");s.innerHTML=a;let r=s.content.firstChild;return t&&(r=r.firstChild),r}function Nt(a,n=window.document){const t=n[Us]||(n[Us]=new Set);for(let s=0,r=a.length;s<r;s++){const i=a[s];t.has(i)||(t.add(i),n.addEventListener(i,Or))}}function Nn(a,n,t){t==null?a.removeAttribute(n):a.setAttribute(n,t)}function rn(a,n){n==null?a.removeAttribute("class"):a.className=n}function Lr(a,n,t,s){if(s)Array.isArray(t)?(a[`$$${n}`]=t[0],a[`$$${n}Data`]=t[1]):a[`$$${n}`]=t;else if(Array.isArray(t)){const r=t[0];a.addEventListener(n,t[0]=i=>r.call(a,t[1],i))}else a.addEventListener(n,t)}function oo(a,n,t){if(!n)return t?Nn(a,"style"):n;const s=a.style;if(typeof n=="string")return s.cssText=n;typeof t=="string"&&(s.cssText=t=void 0),t||(t={}),n||(n={});let r,i;for(i in t)n[i]==null&&s.removeProperty(i),delete t[i];for(i in n)r=n[i],r!==t[i]&&(s.setProperty(i,r),t[i]=r);return t}function Hs(a,n,t){return Ct(()=>a(n,t))}function Ae(a,n,t,s){if(t!==void 0&&!s&&(s=[]),typeof n!="function")return Dn(a,n,s,t);dt(r=>Dn(a,n(),r,t),s)}function Or(a){const n=`$$${a.type}`;let t=a.composedPath&&a.composedPath()[0]||a.target;for(a.target!==t&&Object.defineProperty(a,"target",{configurable:!0,value:t}),Object.defineProperty(a,"currentTarget",{configurable:!0,get(){return t||document}}),ct.registry&&!ct.done&&(ct.done=!0,document.querySelectorAll("[id^=pl-]").forEach(s=>{for(;s&&s.nodeType!==8&&s.nodeValue!=="pl-"+a;){let r=s.nextSibling;s.remove(),s=r}s&&s.remove()}));t;){const s=t[n];if(s&&!t.disabled){const r=t[`${n}Data`];if(r!==void 0?s.call(t,r,a):s.call(t,a),a.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function Dn(a,n,t,s,r){for(ct.context&&!t&&(t=[...a.childNodes]);typeof t=="function";)t=t();if(n===t)return t;const i=typeof n,p=s!==void 0;if(a=p&&t[0]&&t[0].parentNode||a,i==="string"||i==="number"){if(ct.context)return t;if(i==="number"&&(n=n.toString()),p){let c=t[0];c&&c.nodeType===3?c.data=n:c=document.createTextNode(n),t=Qt(a,t,s,c)}else t!==""&&typeof t=="string"?t=a.firstChild.data=n:t=a.textContent=n}else if(n==null||i==="boolean"){if(ct.context)return t;t=Qt(a,t,s)}else{if(i==="function")return dt(()=>{let c=n();for(;typeof c=="function";)c=c();t=Dn(a,c,t,s)}),()=>t;if(Array.isArray(n)){const c=[],u=t&&Array.isArray(t);if(gi(c,n,t,r))return dt(()=>t=Dn(a,c,t,s,!0)),()=>t;if(ct.context){if(!c.length)return t;for(let b=0;b<c.length;b++)if(c[b].parentNode)return t=c}if(c.length===0){if(t=Qt(a,t,s),p)return t}else u?t.length===0?Ws(a,c,s):Mr(a,t,c):(t&&Qt(a),Ws(a,c));t=c}else if(n instanceof Node){if(ct.context&&n.parentNode)return t=p?[n]:n;if(Array.isArray(t)){if(p)return t=Qt(a,t,s,n);Qt(a,t,null,n)}else t==null||t===""||!a.firstChild?a.appendChild(n):a.replaceChild(n,a.firstChild);t=n}}return t}function gi(a,n,t,s){let r=!1;for(let i=0,p=n.length;i<p;i++){let c=n[i],u=t&&t[i];if(c instanceof Node)a.push(c);else if(!(c==null||c===!0||c===!1))if(Array.isArray(c))r=gi(a,c,u)||r;else if(typeof c=="function")if(s){for(;typeof c=="function";)c=c();r=gi(a,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||r}else a.push(c),r=!0;else{const b=String(c);u&&u.nodeType===3&&u.data===b?a.push(u):a.push(document.createTextNode(b))}}return r}function Ws(a,n,t=null){for(let s=0,r=n.length;s<r;s++)a.insertBefore(n[s],t)}function Qt(a,n,t,s){if(t===void 0)return a.textContent="";const r=s||document.createTextNode("");if(n.length){let i=!1;for(let p=n.length-1;p>=0;p--){const c=n[p];if(r!==c){const u=c.parentNode===a;!i&&!p?u?a.replaceChild(r,c):a.insertBefore(r,t):u&&c.remove()}else i=!0}}else a.insertBefore(r,t);return[r]}var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dr={exports:{}};/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(a,n){(function(t,s){a.exports=s()})(Nr,function(){const t="transitionend",s=l=>{let e=l.getAttribute("data-bs-target");if(!e||e==="#"){let o=l.getAttribute("href");if(!o||!o.includes("#")&&!o.startsWith("."))return null;o.includes("#")&&!o.startsWith("#")&&(o=`#${o.split("#")[1]}`),e=o&&o!=="#"?o.trim():null}return e},r=l=>{const e=s(l);return e&&document.querySelector(e)?e:null},i=l=>{const e=s(l);return e?document.querySelector(e):null},p=l=>{l.dispatchEvent(new Event(t))},c=l=>!(!l||typeof l!="object")&&(l.jquery!==void 0&&(l=l[0]),l.nodeType!==void 0),u=l=>c(l)?l.jquery?l[0]:l:typeof l=="string"&&l.length>0?document.querySelector(l):null,b=l=>{if(!c(l)||l.getClientRects().length===0)return!1;const e=getComputedStyle(l).getPropertyValue("visibility")==="visible",o=l.closest("details:not([open])");if(!o)return e;if(o!==l){const d=l.closest("summary");if(d&&d.parentNode!==o||d===null)return!1}return e},w=l=>!l||l.nodeType!==Node.ELEMENT_NODE||!!l.classList.contains("disabled")||(l.disabled!==void 0?l.disabled:l.hasAttribute("disabled")&&l.getAttribute("disabled")!=="false"),j=l=>{if(!document.documentElement.attachShadow)return null;if(typeof l.getRootNode=="function"){const e=l.getRootNode();return e instanceof ShadowRoot?e:null}return l instanceof ShadowRoot?l:l.parentNode?j(l.parentNode):null},D=()=>{},x=l=>{l.offsetHeight},C=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,E=[],L=()=>document.documentElement.dir==="rtl",M=l=>{var e;e=()=>{const o=C();if(o){const d=l.NAME,h=o.fn[d];o.fn[d]=l.jQueryInterface,o.fn[d].Constructor=l,o.fn[d].noConflict=()=>(o.fn[d]=h,l.jQueryInterface)}},document.readyState==="loading"?(E.length||document.addEventListener("DOMContentLoaded",()=>{for(const o of E)o()}),E.push(e)):e()},N=l=>{typeof l=="function"&&l()},F=(l,e,o=!0)=>{if(!o)return void N(l);const d=(v=>{if(!v)return 0;let{transitionDuration:P,transitionDelay:k}=window.getComputedStyle(v);const V=Number.parseFloat(P),B=Number.parseFloat(k);return V||B?(P=P.split(",")[0],k=k.split(",")[0],1e3*(Number.parseFloat(P)+Number.parseFloat(k))):0})(e)+5;let h=!1;const f=({target:v})=>{v===e&&(h=!0,e.removeEventListener(t,f),N(l))};e.addEventListener(t,f),setTimeout(()=>{h||p(e)},d)},O=(l,e,o,d)=>{const h=l.length;let f=l.indexOf(e);return f===-1?!o&&d?l[h-1]:l[0]:(f+=o?1:-1,d&&(f=(f+h)%h),l[Math.max(0,Math.min(f,h-1))])},se=/[^.]*(?=\..*)\.|.*/,R=/\..*/,A=/::\d+$/,I={};let ee=1;const pe={mouseenter:"mouseover",mouseleave:"mouseout"},q=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ve(l,e){return e&&`${e}::${ee++}`||l.uidEvent||ee++}function de(l){const e=Ve(l);return l.uidEvent=e,I[e]=I[e]||{},I[e]}function Ce(l,e,o=null){return Object.values(l).find(d=>d.callable===e&&d.delegationSelector===o)}function He(l,e,o){const d=typeof e=="string",h=d?o:e||o;let f=_(l);return q.has(f)||(f=l),[d,h,f]}function ue(l,e,o,d,h){if(typeof e!="string"||!l)return;let[f,v,P]=He(e,o,d);e in pe&&(v=(z=>function(K){if(!K.relatedTarget||K.relatedTarget!==K.delegateTarget&&!K.delegateTarget.contains(K.relatedTarget))return z.call(this,K)})(v));const k=de(l),V=k[P]||(k[P]={}),B=Ce(V,v,f?o:null);if(B)return void(B.oneOff=B.oneOff&&h);const S=Ve(v,e.replace(se,"")),ne=f?function(U,z,K){return function X(be){const Pe=U.querySelectorAll(z);for(let{target:re}=be;re&&re!==this;re=re.parentNode)for(const fe of Pe)if(fe===re)return le(be,{delegateTarget:re}),X.oneOff&&g.off(U,be.type,z,K),K.apply(re,[be])}}(l,o,v):function(U,z){return function K(X){return le(X,{delegateTarget:U}),K.oneOff&&g.off(U,X.type,z),z.apply(U,[X])}}(l,v);ne.delegationSelector=f?o:null,ne.callable=v,ne.oneOff=h,ne.uidEvent=S,V[S]=ne,l.addEventListener(P,ne,f)}function Z(l,e,o,d,h){const f=Ce(e[o],d,h);f&&(l.removeEventListener(o,f,Boolean(h)),delete e[o][f.uidEvent])}function he(l,e,o,d){const h=e[o]||{};for(const f of Object.keys(h))if(f.includes(d)){const v=h[f];Z(l,e,o,v.callable,v.delegationSelector)}}function _(l){return l=l.replace(R,""),pe[l]||l}const g={on(l,e,o,d){ue(l,e,o,d,!1)},one(l,e,o,d){ue(l,e,o,d,!0)},off(l,e,o,d){if(typeof e!="string"||!l)return;const[h,f,v]=He(e,o,d),P=v!==e,k=de(l),V=k[v]||{},B=e.startsWith(".");if(f===void 0){if(B)for(const S of Object.keys(k))he(l,k,S,e.slice(1));for(const S of Object.keys(V)){const ne=S.replace(A,"");if(!P||e.includes(ne)){const U=V[S];Z(l,k,v,U.callable,U.delegationSelector)}}}else{if(!Object.keys(V).length)return;Z(l,k,v,f,h?o:null)}},trigger(l,e,o){if(typeof e!="string"||!l)return null;const d=C();let h=null,f=!0,v=!0,P=!1;e!==_(e)&&d&&(h=d.Event(e,o),d(l).trigger(h),f=!h.isPropagationStopped(),v=!h.isImmediatePropagationStopped(),P=h.isDefaultPrevented());let k=new Event(e,{bubbles:f,cancelable:!0});return k=le(k,o),P&&k.preventDefault(),v&&l.dispatchEvent(k),k.defaultPrevented&&h&&h.preventDefault(),k}};function le(l,e){for(const[o,d]of Object.entries(e||{}))try{l[o]=d}catch{Object.defineProperty(l,o,{configurable:!0,get:()=>d})}return l}const Y=new Map,H={set(l,e,o){Y.has(l)||Y.set(l,new Map);const d=Y.get(l);d.has(e)||d.size===0?d.set(e,o):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(d.keys())[0]}.`)},get:(l,e)=>Y.has(l)&&Y.get(l).get(e)||null,remove(l,e){if(!Y.has(l))return;const o=Y.get(l);o.delete(e),o.size===0&&Y.delete(l)}};function oe(l){if(l==="true")return!0;if(l==="false")return!1;if(l===Number(l).toString())return Number(l);if(l===""||l==="null")return null;if(typeof l!="string")return l;try{return JSON.parse(decodeURIComponent(l))}catch{return l}}function ge(l){return l.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const me={setDataAttribute(l,e,o){l.setAttribute(`data-bs-${ge(e)}`,o)},removeDataAttribute(l,e){l.removeAttribute(`data-bs-${ge(e)}`)},getDataAttributes(l){if(!l)return{};const e={},o=Object.keys(l.dataset).filter(d=>d.startsWith("bs")&&!d.startsWith("bsConfig"));for(const d of o){let h=d.replace(/^bs/,"");h=h.charAt(0).toLowerCase()+h.slice(1,h.length),e[h]=oe(l.dataset[d])}return e},getDataAttribute:(l,e)=>oe(l.getAttribute(`data-bs-${ge(e)}`))};class Le{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,o){const d=c(o)?me.getDataAttribute(o,"config"):{};return{...this.constructor.Default,...typeof d=="object"?d:{},...c(o)?me.getDataAttributes(o):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,o=this.constructor.DefaultType){for(const h of Object.keys(o)){const f=o[h],v=e[h],P=c(v)?"element":(d=v)==null?`${d}`:Object.prototype.toString.call(d).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(f).test(P))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${h}" provided type "${P}" but expected type "${f}".`)}var d}}class Oe extends Le{constructor(e,o){super(),(e=u(e))&&(this._element=e,this._config=this._getConfig(o),H.set(this._element,this.constructor.DATA_KEY,this))}dispose(){H.remove(this._element,this.constructor.DATA_KEY),g.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,o,d=!0){F(e,o,d)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return H.get(u(e),this.DATA_KEY)}static getOrCreateInstance(e,o={}){return this.getInstance(e)||new this(e,typeof o=="object"?o:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const ut=(l,e="hide")=>{const o=`click.dismiss${l.EVENT_KEY}`,d=l.NAME;g.on(document,o,`[data-bs-dismiss="${d}"]`,function(h){if(["A","AREA"].includes(this.tagName)&&h.preventDefault(),w(this))return;const f=i(this)||this.closest(`.${d}`);l.getOrCreateInstance(f)[e]()})};class st extends Oe{static get NAME(){return"alert"}close(){if(g.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),g.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(e){return this.each(function(){const o=st.getOrCreateInstance(this);if(typeof e=="string"){if(o[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);o[e](this)}})}}ut(st,"close"),M(st);const kt='[data-bs-toggle="button"]';class bt extends Oe{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(e){return this.each(function(){const o=bt.getOrCreateInstance(this);e==="toggle"&&o[e]()})}}g.on(document,"click.bs.button.data-api",kt,l=>{l.preventDefault();const e=l.target.closest(kt);bt.getOrCreateInstance(e).toggle()}),M(bt);const J={find:(l,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,l)),findOne:(l,e=document.documentElement)=>Element.prototype.querySelector.call(e,l),children:(l,e)=>[].concat(...l.children).filter(o=>o.matches(e)),parents(l,e){const o=[];let d=l.parentNode.closest(e);for(;d;)o.push(d),d=d.parentNode.closest(e);return o},prev(l,e){let o=l.previousElementSibling;for(;o;){if(o.matches(e))return[o];o=o.previousElementSibling}return[]},next(l,e){let o=l.nextElementSibling;for(;o;){if(o.matches(e))return[o];o=o.nextElementSibling}return[]},focusableChildren(l){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(o=>`${o}:not([tabindex^="-"])`).join(",");return this.find(e,l).filter(o=>!w(o)&&b(o))}},cn={endCallback:null,leftCallback:null,rightCallback:null},dn={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class $ extends Le{constructor(e,o){super(),this._element=e,e&&$.isSupported()&&(this._config=this._getConfig(o),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return cn}static get DefaultType(){return dn}static get NAME(){return"swipe"}dispose(){g.off(this._element,".bs.swipe")}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),N(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const o=e/this._deltaX;this._deltaX=0,o&&N(o>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(g.on(this._element,"pointerdown.bs.swipe",e=>this._start(e)),g.on(this._element,"pointerup.bs.swipe",e=>this._end(e)),this._element.classList.add("pointer-event")):(g.on(this._element,"touchstart.bs.swipe",e=>this._start(e)),g.on(this._element,"touchmove.bs.swipe",e=>this._move(e)),g.on(this._element,"touchend.bs.swipe",e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType==="pen"||e.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const m="next",te="prev",Q="left",yt="right",Me="slid.bs.carousel",Ne="carousel",Ye="active",ht={ArrowLeft:yt,ArrowRight:Q},ft={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},pt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ze extends Oe{constructor(e,o){super(e,o),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=J.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ne&&this.cycle()}static get Default(){return ft}static get DefaultType(){return pt}static get NAME(){return"carousel"}next(){this._slide(m)}nextWhenVisible(){!document.hidden&&b(this._element)&&this.next()}prev(){this._slide(te)}pause(){this._isSliding&&p(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?g.one(this._element,Me,()=>this.cycle()):this.cycle())}to(e){const o=this._getItems();if(e>o.length-1||e<0)return;if(this._isSliding)return void g.one(this._element,Me,()=>this.to(e));const d=this._getItemIndex(this._getActive());if(d===e)return;const h=e>d?m:te;this._slide(h,o[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&g.on(this._element,"keydown.bs.carousel",e=>this._keydown(e)),this._config.pause==="hover"&&(g.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),g.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&$.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of J.find(".carousel-item img",this._element))g.on(o,"dragstart.bs.carousel",d=>d.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(Q)),rightCallback:()=>this._slide(this._directionToOrder(yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new $(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const o=ht[e.key];o&&(e.preventDefault(),this._slide(this._directionToOrder(o)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const o=J.findOne(".active",this._indicatorsElement);o.classList.remove(Ye),o.removeAttribute("aria-current");const d=J.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);d&&(d.classList.add(Ye),d.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const o=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=o||this._config.defaultInterval}_slide(e,o=null){if(this._isSliding)return;const d=this._getActive(),h=e===m,f=o||O(this._getItems(),d,h,this._config.wrap);if(f===d)return;const v=this._getItemIndex(f),P=S=>g.trigger(this._element,S,{relatedTarget:f,direction:this._orderToDirection(e),from:this._getItemIndex(d),to:v});if(P("slide.bs.carousel").defaultPrevented||!d||!f)return;const k=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(v),this._activeElement=f;const V=h?"carousel-item-start":"carousel-item-end",B=h?"carousel-item-next":"carousel-item-prev";f.classList.add(B),x(f),d.classList.add(V),f.classList.add(V),this._queueCallback(()=>{f.classList.remove(V,B),f.classList.add(Ye),d.classList.remove(Ye,B,V),this._isSliding=!1,P(Me)},d,this._isAnimated()),k&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return J.findOne(".active.carousel-item",this._element)}_getItems(){return J.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return L()?e===Q?te:m:e===Q?m:te}_orderToDirection(e){return L()?e===te?Q:yt:e===te?yt:Q}static jQueryInterface(e){return this.each(function(){const o=ze.getOrCreateInstance(this,e);if(typeof e!="number"){if(typeof e=="string"){if(o[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);o[e]()}}else o.to(e)})}}g.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(l){const e=i(this);if(!e||!e.classList.contains(Ne))return;l.preventDefault();const o=ze.getOrCreateInstance(e),d=this.getAttribute("data-bs-slide-to");return d?(o.to(d),void o._maybeEnableCycle()):me.getDataAttribute(this,"slide")==="next"?(o.next(),void o._maybeEnableCycle()):(o.prev(),void o._maybeEnableCycle())}),g.on(window,"load.bs.carousel.data-api",()=>{const l=J.find('[data-bs-ride="carousel"]');for(const e of l)ze.getOrCreateInstance(e)}),M(ze);const gt="show",un="collapse",hn="collapsing",Fn='[data-bs-toggle="collapse"]',go={parent:null,toggle:!0},mo={parent:"(null|element)",toggle:"boolean"};class Dt extends Oe{constructor(e,o){super(e,o),this._isTransitioning=!1,this._triggerArray=[];const d=J.find(Fn);for(const h of d){const f=r(h),v=J.find(f).filter(P=>P===this._element);f!==null&&v.length&&this._triggerArray.push(h)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return go}static get DefaultType(){return mo}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(h=>h!==this._element).map(h=>Dt.getOrCreateInstance(h,{toggle:!1}))),e.length&&e[0]._isTransitioning||g.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const h of e)h.hide();const o=this._getDimension();this._element.classList.remove(un),this._element.classList.add(hn),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const d=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(hn),this._element.classList.add(un,gt),this._element.style[o]="",g.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[o]=`${this._element[d]}px`}hide(){if(this._isTransitioning||!this._isShown()||g.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,x(this._element),this._element.classList.add(hn),this._element.classList.remove(un,gt);for(const o of this._triggerArray){const d=i(o);d&&!this._isShown(d)&&this._addAriaAndCollapsedClass([o],!1)}this._isTransitioning=!0,this._element.style[e]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(hn),this._element.classList.add(un),g.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(e=this._element){return e.classList.contains(gt)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=u(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fn);for(const o of e){const d=i(o);d&&this._addAriaAndCollapsedClass([o],this._isShown(d))}}_getFirstLevelChildren(e){const o=J.find(":scope .collapse .collapse",this._config.parent);return J.find(e,this._config.parent).filter(d=>!o.includes(d))}_addAriaAndCollapsedClass(e,o){if(e.length)for(const d of e)d.classList.toggle("collapsed",!o),d.setAttribute("aria-expanded",o)}static jQueryInterface(e){const o={};return typeof e=="string"&&/show|hide/.test(e)&&(o.toggle=!1),this.each(function(){const d=Dt.getOrCreateInstance(this,o);if(typeof e=="string"){if(d[e]===void 0)throw new TypeError(`No method named "${e}"`);d[e]()}})}}g.on(document,"click.bs.collapse.data-api",Fn,function(l){(l.target.tagName==="A"||l.delegateTarget&&l.delegateTarget.tagName==="A")&&l.preventDefault();const e=r(this),o=J.find(e);for(const d of o)Dt.getOrCreateInstance(d,{toggle:!1}).toggle()}),M(Dt);var qe="top",Qe="bottom",Ke="right",$e="left",fn="auto",Rt=[qe,Qe,Ke,$e],Tt="start",qt="end",wi="clippingParents",jn="viewport",$t="popper",bi="reference",Un=Rt.reduce(function(l,e){return l.concat([e+"-"+Tt,e+"-"+qt])},[]),Hn=[].concat(Rt,[fn]).reduce(function(l,e){return l.concat([e,e+"-"+Tt,e+"-"+qt])},[]),yi="beforeRead",_i="read",Pi="afterRead",xi="beforeMain",Ai="main",Ci="afterMain",ki="beforeWrite",Ti="write",Ei="afterWrite",Ii=[yi,_i,Pi,xi,Ai,Ci,ki,Ti,Ei];function ot(l){return l?(l.nodeName||"").toLowerCase():null}function Xe(l){if(l==null)return window;if(l.toString()!=="[object Window]"){var e=l.ownerDocument;return e&&e.defaultView||window}return l}function Et(l){return l instanceof Xe(l).Element||l instanceof Element}function Je(l){return l instanceof Xe(l).HTMLElement||l instanceof HTMLElement}function Wn(l){return typeof ShadowRoot<"u"&&(l instanceof Xe(l).ShadowRoot||l instanceof ShadowRoot)}const Qn={name:"applyStyles",enabled:!0,phase:"write",fn:function(l){var e=l.state;Object.keys(e.elements).forEach(function(o){var d=e.styles[o]||{},h=e.attributes[o]||{},f=e.elements[o];Je(f)&&ot(f)&&(Object.assign(f.style,d),Object.keys(h).forEach(function(v){var P=h[v];P===!1?f.removeAttribute(v):f.setAttribute(v,P===!0?"":P)}))})},effect:function(l){var e=l.state,o={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,o.popper),e.styles=o,e.elements.arrow&&Object.assign(e.elements.arrow.style,o.arrow),function(){Object.keys(e.elements).forEach(function(d){var h=e.elements[d],f=e.attributes[d]||{},v=Object.keys(e.styles.hasOwnProperty(d)?e.styles[d]:o[d]).reduce(function(P,k){return P[k]="",P},{});Je(h)&&ot(h)&&(Object.assign(h.style,v),Object.keys(f).forEach(function(P){h.removeAttribute(P)}))})}},requires:["computeStyles"]};function rt(l){return l.split("-")[0]}var It=Math.max,pn=Math.min,Ft=Math.round;function Kn(){var l=navigator.userAgentData;return l!=null&&l.brands?l.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Si(){return!/^((?!chrome|android).)*safari/i.test(Kn())}function jt(l,e,o){e===void 0&&(e=!1),o===void 0&&(o=!1);var d=l.getBoundingClientRect(),h=1,f=1;e&&Je(l)&&(h=l.offsetWidth>0&&Ft(d.width)/l.offsetWidth||1,f=l.offsetHeight>0&&Ft(d.height)/l.offsetHeight||1);var v=(Et(l)?Xe(l):window).visualViewport,P=!Si()&&o,k=(d.left+(P&&v?v.offsetLeft:0))/h,V=(d.top+(P&&v?v.offsetTop:0))/f,B=d.width/h,S=d.height/f;return{width:B,height:S,top:V,right:k+B,bottom:V+S,left:k,x:k,y:V}}function Gn(l){var e=jt(l),o=l.offsetWidth,d=l.offsetHeight;return Math.abs(e.width-o)<=1&&(o=e.width),Math.abs(e.height-d)<=1&&(d=e.height),{x:l.offsetLeft,y:l.offsetTop,width:o,height:d}}function Vi(l,e){var o=e.getRootNode&&e.getRootNode();if(l.contains(e))return!0;if(o&&Wn(o)){var d=e;do{if(d&&l.isSameNode(d))return!0;d=d.parentNode||d.host}while(d)}return!1}function mt(l){return Xe(l).getComputedStyle(l)}function vo(l){return["table","td","th"].indexOf(ot(l))>=0}function _t(l){return((Et(l)?l.ownerDocument:l.document)||window.document).documentElement}function gn(l){return ot(l)==="html"?l:l.assignedSlot||l.parentNode||(Wn(l)?l.host:null)||_t(l)}function Mi(l){return Je(l)&&mt(l).position!=="fixed"?l.offsetParent:null}function zt(l){for(var e=Xe(l),o=Mi(l);o&&vo(o)&&mt(o).position==="static";)o=Mi(o);return o&&(ot(o)==="html"||ot(o)==="body"&&mt(o).position==="static")?e:o||function(d){var h=/firefox/i.test(Kn());if(/Trident/i.test(Kn())&&Je(d)&&mt(d).position==="fixed")return null;var f=gn(d);for(Wn(f)&&(f=f.host);Je(f)&&["html","body"].indexOf(ot(f))<0;){var v=mt(f);if(v.transform!=="none"||v.perspective!=="none"||v.contain==="paint"||["transform","perspective"].indexOf(v.willChange)!==-1||h&&v.willChange==="filter"||h&&v.filter&&v.filter!=="none")return f;f=f.parentNode}return null}(l)||e}function Yn(l){return["top","bottom"].indexOf(l)>=0?"x":"y"}function Xt(l,e,o){return It(l,pn(e,o))}function Bi(l){return Object.assign({},{top:0,right:0,bottom:0,left:0},l)}function Li(l,e){return e.reduce(function(o,d){return o[d]=l,o},{})}const Oi={name:"arrow",enabled:!0,phase:"main",fn:function(l){var e,o=l.state,d=l.name,h=l.options,f=o.elements.arrow,v=o.modifiersData.popperOffsets,P=rt(o.placement),k=Yn(P),V=[$e,Ke].indexOf(P)>=0?"height":"width";if(f&&v){var B=function(ye,we){return Bi(typeof(ye=typeof ye=="function"?ye(Object.assign({},we.rects,{placement:we.placement})):ye)!="number"?ye:Li(ye,Rt))}(h.padding,o),S=Gn(f),ne=k==="y"?qe:$e,U=k==="y"?Qe:Ke,z=o.rects.reference[V]+o.rects.reference[k]-v[k]-o.rects.popper[V],K=v[k]-o.rects.reference[k],X=zt(f),be=X?k==="y"?X.clientHeight||0:X.clientWidth||0:0,Pe=z/2-K/2,re=B[ne],fe=be-S[V]-B[U],ie=be/2-S[V]/2+Pe,ae=Xt(re,ie,fe),ve=k;o.modifiersData[d]=((e={})[ve]=ae,e.centerOffset=ae-ie,e)}},effect:function(l){var e=l.state,o=l.options.element,d=o===void 0?"[data-popper-arrow]":o;d!=null&&(typeof d!="string"||(d=e.elements.popper.querySelector(d)))&&Vi(e.elements.popper,d)&&(e.elements.arrow=d)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ut(l){return l.split("-")[1]}var wo={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ni(l){var e,o=l.popper,d=l.popperRect,h=l.placement,f=l.variation,v=l.offsets,P=l.position,k=l.gpuAcceleration,V=l.adaptive,B=l.roundOffsets,S=l.isFixed,ne=v.x,U=ne===void 0?0:ne,z=v.y,K=z===void 0?0:z,X=typeof B=="function"?B({x:U,y:K}):{x:U,y:K};U=X.x,K=X.y;var be=v.hasOwnProperty("x"),Pe=v.hasOwnProperty("y"),re=$e,fe=qe,ie=window;if(V){var ae=zt(o),ve="clientHeight",ye="clientWidth";ae===Xe(o)&&mt(ae=_t(o)).position!=="static"&&P==="absolute"&&(ve="scrollHeight",ye="scrollWidth"),(h===qe||(h===$e||h===Ke)&&f===qt)&&(fe=Qe,K-=(S&&ae===ie&&ie.visualViewport?ie.visualViewport.height:ae[ve])-d.height,K*=k?1:-1),h!==$e&&(h!==qe&&h!==Qe||f!==qt)||(re=Ke,U-=(S&&ae===ie&&ie.visualViewport?ie.visualViewport.width:ae[ye])-d.width,U*=k?1:-1)}var we,Te=Object.assign({position:P},V&&wo),Ge=B===!0?function(it){var Fe=it.x,Ze=it.y,je=window.devicePixelRatio||1;return{x:Ft(Fe*je)/je||0,y:Ft(Ze*je)/je||0}}({x:U,y:K}):{x:U,y:K};return U=Ge.x,K=Ge.y,k?Object.assign({},Te,((we={})[fe]=Pe?"0":"",we[re]=be?"0":"",we.transform=(ie.devicePixelRatio||1)<=1?"translate("+U+"px, "+K+"px)":"translate3d("+U+"px, "+K+"px, 0)",we)):Object.assign({},Te,((e={})[fe]=Pe?K+"px":"",e[re]=be?U+"px":"",e.transform="",e))}const zn={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(l){var e=l.state,o=l.options,d=o.gpuAcceleration,h=d===void 0||d,f=o.adaptive,v=f===void 0||f,P=o.roundOffsets,k=P===void 0||P,V={placement:rt(e.placement),variation:Ut(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:h,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ni(Object.assign({},V,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:v,roundOffsets:k})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ni(Object.assign({},V,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:k})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var mn={passive:!0};const Xn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(l){var e=l.state,o=l.instance,d=l.options,h=d.scroll,f=h===void 0||h,v=d.resize,P=v===void 0||v,k=Xe(e.elements.popper),V=[].concat(e.scrollParents.reference,e.scrollParents.popper);return f&&V.forEach(function(B){B.addEventListener("scroll",o.update,mn)}),P&&k.addEventListener("resize",o.update,mn),function(){f&&V.forEach(function(B){B.removeEventListener("scroll",o.update,mn)}),P&&k.removeEventListener("resize",o.update,mn)}},data:{}};var bo={left:"right",right:"left",bottom:"top",top:"bottom"};function vn(l){return l.replace(/left|right|bottom|top/g,function(e){return bo[e]})}var yo={start:"end",end:"start"};function Di(l){return l.replace(/start|end/g,function(e){return yo[e]})}function Jn(l){var e=Xe(l);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Zn(l){return jt(_t(l)).left+Jn(l).scrollLeft}function ei(l){var e=mt(l),o=e.overflow,d=e.overflowX,h=e.overflowY;return/auto|scroll|overlay|hidden/.test(o+h+d)}function Ri(l){return["html","body","#document"].indexOf(ot(l))>=0?l.ownerDocument.body:Je(l)&&ei(l)?l:Ri(gn(l))}function Jt(l,e){var o;e===void 0&&(e=[]);var d=Ri(l),h=d===((o=l.ownerDocument)==null?void 0:o.body),f=Xe(d),v=h?[f].concat(f.visualViewport||[],ei(d)?d:[]):d,P=e.concat(v);return h?P:P.concat(Jt(gn(v)))}function ti(l){return Object.assign({},l,{left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height})}function qi(l,e,o){return e===jn?ti(function(d,h){var f=Xe(d),v=_t(d),P=f.visualViewport,k=v.clientWidth,V=v.clientHeight,B=0,S=0;if(P){k=P.width,V=P.height;var ne=Si();(ne||!ne&&h==="fixed")&&(B=P.offsetLeft,S=P.offsetTop)}return{width:k,height:V,x:B+Zn(d),y:S}}(l,o)):Et(e)?function(d,h){var f=jt(d,!1,h==="fixed");return f.top=f.top+d.clientTop,f.left=f.left+d.clientLeft,f.bottom=f.top+d.clientHeight,f.right=f.left+d.clientWidth,f.width=d.clientWidth,f.height=d.clientHeight,f.x=f.left,f.y=f.top,f}(e,o):ti(function(d){var h,f=_t(d),v=Jn(d),P=(h=d.ownerDocument)==null?void 0:h.body,k=It(f.scrollWidth,f.clientWidth,P?P.scrollWidth:0,P?P.clientWidth:0),V=It(f.scrollHeight,f.clientHeight,P?P.scrollHeight:0,P?P.clientHeight:0),B=-v.scrollLeft+Zn(d),S=-v.scrollTop;return mt(P||f).direction==="rtl"&&(B+=It(f.clientWidth,P?P.clientWidth:0)-k),{width:k,height:V,x:B,y:S}}(_t(l)))}function $i(l){var e,o=l.reference,d=l.element,h=l.placement,f=h?rt(h):null,v=h?Ut(h):null,P=o.x+o.width/2-d.width/2,k=o.y+o.height/2-d.height/2;switch(f){case qe:e={x:P,y:o.y-d.height};break;case Qe:e={x:P,y:o.y+o.height};break;case Ke:e={x:o.x+o.width,y:k};break;case $e:e={x:o.x-d.width,y:k};break;default:e={x:o.x,y:o.y}}var V=f?Yn(f):null;if(V!=null){var B=V==="y"?"height":"width";switch(v){case Tt:e[V]=e[V]-(o[B]/2-d[B]/2);break;case qt:e[V]=e[V]+(o[B]/2-d[B]/2)}}return e}function Ht(l,e){e===void 0&&(e={});var o=e,d=o.placement,h=d===void 0?l.placement:d,f=o.strategy,v=f===void 0?l.strategy:f,P=o.boundary,k=P===void 0?wi:P,V=o.rootBoundary,B=V===void 0?jn:V,S=o.elementContext,ne=S===void 0?$t:S,U=o.altBoundary,z=U!==void 0&&U,K=o.padding,X=K===void 0?0:K,be=Bi(typeof X!="number"?X:Li(X,Rt)),Pe=ne===$t?bi:$t,re=l.rects.popper,fe=l.elements[z?Pe:ne],ie=function(Fe,Ze,je,Be){var lt=Ze==="clippingParents"?function(_e){var Ue=Jt(gn(_e)),et=["absolute","fixed"].indexOf(mt(_e).position)>=0&&Je(_e)?zt(_e):_e;return Et(et)?Ue.filter(function(Pt){return Et(Pt)&&Vi(Pt,et)&&ot(Pt)!=="body"}):[]}(Fe):[].concat(Ze),at=[].concat(lt,[je]),Wt=at[0],Ie=at.reduce(function(_e,Ue){var et=qi(Fe,Ue,Be);return _e.top=It(et.top,_e.top),_e.right=pn(et.right,_e.right),_e.bottom=pn(et.bottom,_e.bottom),_e.left=It(et.left,_e.left),_e},qi(Fe,Wt,Be));return Ie.width=Ie.right-Ie.left,Ie.height=Ie.bottom-Ie.top,Ie.x=Ie.left,Ie.y=Ie.top,Ie}(Et(fe)?fe:fe.contextElement||_t(l.elements.popper),k,B,v),ae=jt(l.elements.reference),ve=$i({reference:ae,element:re,strategy:"absolute",placement:h}),ye=ti(Object.assign({},re,ve)),we=ne===$t?ye:ae,Te={top:ie.top-we.top+be.top,bottom:we.bottom-ie.bottom+be.bottom,left:ie.left-we.left+be.left,right:we.right-ie.right+be.right},Ge=l.modifiersData.offset;if(ne===$t&&Ge){var it=Ge[h];Object.keys(Te).forEach(function(Fe){var Ze=[Ke,Qe].indexOf(Fe)>=0?1:-1,je=[qe,Qe].indexOf(Fe)>=0?"y":"x";Te[Fe]+=it[je]*Ze})}return Te}function _o(l,e){e===void 0&&(e={});var o=e,d=o.placement,h=o.boundary,f=o.rootBoundary,v=o.padding,P=o.flipVariations,k=o.allowedAutoPlacements,V=k===void 0?Hn:k,B=Ut(d),S=B?P?Un:Un.filter(function(z){return Ut(z)===B}):Rt,ne=S.filter(function(z){return V.indexOf(z)>=0});ne.length===0&&(ne=S);var U=ne.reduce(function(z,K){return z[K]=Ht(l,{placement:K,boundary:h,rootBoundary:f,padding:v})[rt(K)],z},{});return Object.keys(U).sort(function(z,K){return U[z]-U[K]})}const Fi={name:"flip",enabled:!0,phase:"main",fn:function(l){var e=l.state,o=l.options,d=l.name;if(!e.modifiersData[d]._skip){for(var h=o.mainAxis,f=h===void 0||h,v=o.altAxis,P=v===void 0||v,k=o.fallbackPlacements,V=o.padding,B=o.boundary,S=o.rootBoundary,ne=o.altBoundary,U=o.flipVariations,z=U===void 0||U,K=o.allowedAutoPlacements,X=e.options.placement,be=rt(X),Pe=k||(be!==X&&z?function(_e){if(rt(_e)===fn)return[];var Ue=vn(_e);return[Di(_e),Ue,Di(Ue)]}(X):[vn(X)]),re=[X].concat(Pe).reduce(function(_e,Ue){return _e.concat(rt(Ue)===fn?_o(e,{placement:Ue,boundary:B,rootBoundary:S,padding:V,flipVariations:z,allowedAutoPlacements:K}):Ue)},[]),fe=e.rects.reference,ie=e.rects.popper,ae=new Map,ve=!0,ye=re[0],we=0;we<re.length;we++){var Te=re[we],Ge=rt(Te),it=Ut(Te)===Tt,Fe=[qe,Qe].indexOf(Ge)>=0,Ze=Fe?"width":"height",je=Ht(e,{placement:Te,boundary:B,rootBoundary:S,altBoundary:ne,padding:V}),Be=Fe?it?Ke:$e:it?Qe:qe;fe[Ze]>ie[Ze]&&(Be=vn(Be));var lt=vn(Be),at=[];if(f&&at.push(je[Ge]<=0),P&&at.push(je[Be]<=0,je[lt]<=0),at.every(function(_e){return _e})){ye=Te,ve=!1;break}ae.set(Te,at)}if(ve)for(var Wt=function(_e){var Ue=re.find(function(et){var Pt=ae.get(et);if(Pt)return Pt.slice(0,_e).every(function(Tn){return Tn})});if(Ue)return ye=Ue,"break"},Ie=z?3:1;Ie>0&&Wt(Ie)!=="break";Ie--);e.placement!==ye&&(e.modifiersData[d]._skip=!0,e.placement=ye,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ji(l,e,o){return o===void 0&&(o={x:0,y:0}),{top:l.top-e.height-o.y,right:l.right-e.width+o.x,bottom:l.bottom-e.height+o.y,left:l.left-e.width-o.x}}function Ui(l){return[qe,Ke,Qe,$e].some(function(e){return l[e]>=0})}const Hi={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(l){var e=l.state,o=l.name,d=e.rects.reference,h=e.rects.popper,f=e.modifiersData.preventOverflow,v=Ht(e,{elementContext:"reference"}),P=Ht(e,{altBoundary:!0}),k=ji(v,d),V=ji(P,h,f),B=Ui(k),S=Ui(V);e.modifiersData[o]={referenceClippingOffsets:k,popperEscapeOffsets:V,isReferenceHidden:B,hasPopperEscaped:S},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":B,"data-popper-escaped":S})}},Wi={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(l){var e=l.state,o=l.options,d=l.name,h=o.offset,f=h===void 0?[0,0]:h,v=Hn.reduce(function(B,S){return B[S]=function(ne,U,z){var K=rt(ne),X=[$e,qe].indexOf(K)>=0?-1:1,be=typeof z=="function"?z(Object.assign({},U,{placement:ne})):z,Pe=be[0],re=be[1];return Pe=Pe||0,re=(re||0)*X,[$e,Ke].indexOf(K)>=0?{x:re,y:Pe}:{x:Pe,y:re}}(S,e.rects,f),B},{}),P=v[e.placement],k=P.x,V=P.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=k,e.modifiersData.popperOffsets.y+=V),e.modifiersData[d]=v}},ni={name:"popperOffsets",enabled:!0,phase:"read",fn:function(l){var e=l.state,o=l.name;e.modifiersData[o]=$i({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},Qi={name:"preventOverflow",enabled:!0,phase:"main",fn:function(l){var e=l.state,o=l.options,d=l.name,h=o.mainAxis,f=h===void 0||h,v=o.altAxis,P=v!==void 0&&v,k=o.boundary,V=o.rootBoundary,B=o.altBoundary,S=o.padding,ne=o.tether,U=ne===void 0||ne,z=o.tetherOffset,K=z===void 0?0:z,X=Ht(e,{boundary:k,rootBoundary:V,padding:S,altBoundary:B}),be=rt(e.placement),Pe=Ut(e.placement),re=!Pe,fe=Yn(be),ie=fe==="x"?"y":"x",ae=e.modifiersData.popperOffsets,ve=e.rects.reference,ye=e.rects.popper,we=typeof K=="function"?K(Object.assign({},e.rects,{placement:e.placement})):K,Te=typeof we=="number"?{mainAxis:we,altAxis:we}:Object.assign({mainAxis:0,altAxis:0},we),Ge=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,it={x:0,y:0};if(ae){if(f){var Fe,Ze=fe==="y"?qe:$e,je=fe==="y"?Qe:Ke,Be=fe==="y"?"height":"width",lt=ae[fe],at=lt+X[Ze],Wt=lt-X[je],Ie=U?-ye[Be]/2:0,_e=Pe===Tt?ve[Be]:ye[Be],Ue=Pe===Tt?-ye[Be]:-ve[Be],et=e.elements.arrow,Pt=U&&et?Gn(et):{width:0,height:0},Tn=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Ss=Tn[Ze],Vs=Tn[je],En=Xt(0,ve[Be],Pt[Be]),dr=re?ve[Be]/2-Ie-En-Ss-Te.mainAxis:_e-En-Ss-Te.mainAxis,ur=re?-ve[Be]/2+Ie+En+Vs+Te.mainAxis:Ue+En+Vs+Te.mainAxis,ci=e.elements.arrow&&zt(e.elements.arrow),hr=ci?fe==="y"?ci.clientTop||0:ci.clientLeft||0:0,Ms=(Fe=Ge?.[fe])!=null?Fe:0,fr=lt+ur-Ms,Bs=Xt(U?pn(at,lt+dr-Ms-hr):at,lt,U?It(Wt,fr):Wt);ae[fe]=Bs,it[fe]=Bs-lt}if(P){var Ls,pr=fe==="x"?qe:$e,gr=fe==="x"?Qe:Ke,Lt=ae[ie],In=ie==="y"?"height":"width",Os=Lt+X[pr],Ns=Lt-X[gr],di=[qe,$e].indexOf(be)!==-1,Ds=(Ls=Ge?.[ie])!=null?Ls:0,Rs=di?Os:Lt-ve[In]-ye[In]-Ds+Te.altAxis,qs=di?Lt+ve[In]+ye[In]-Ds-Te.altAxis:Ns,$s=U&&di?function(mr,vr,ui){var Fs=Xt(mr,vr,ui);return Fs>ui?ui:Fs}(Rs,Lt,qs):Xt(U?Rs:Os,Lt,U?qs:Ns);ae[ie]=$s,it[ie]=$s-Lt}e.modifiersData[d]=it}},requiresIfExists:["offset"]};function Po(l,e,o){o===void 0&&(o=!1);var d,h,f=Je(e),v=Je(e)&&function(S){var ne=S.getBoundingClientRect(),U=Ft(ne.width)/S.offsetWidth||1,z=Ft(ne.height)/S.offsetHeight||1;return U!==1||z!==1}(e),P=_t(e),k=jt(l,v,o),V={scrollLeft:0,scrollTop:0},B={x:0,y:0};return(f||!f&&!o)&&((ot(e)!=="body"||ei(P))&&(V=(d=e)!==Xe(d)&&Je(d)?{scrollLeft:(h=d).scrollLeft,scrollTop:h.scrollTop}:Jn(d)),Je(e)?((B=jt(e,!0)).x+=e.clientLeft,B.y+=e.clientTop):P&&(B.x=Zn(P))),{x:k.left+V.scrollLeft-B.x,y:k.top+V.scrollTop-B.y,width:k.width,height:k.height}}function xo(l){var e=new Map,o=new Set,d=[];function h(f){o.add(f.name),[].concat(f.requires||[],f.requiresIfExists||[]).forEach(function(v){if(!o.has(v)){var P=e.get(v);P&&h(P)}}),d.push(f)}return l.forEach(function(f){e.set(f.name,f)}),l.forEach(function(f){o.has(f.name)||h(f)}),d}var Ki={placement:"bottom",modifiers:[],strategy:"absolute"};function Gi(){for(var l=arguments.length,e=new Array(l),o=0;o<l;o++)e[o]=arguments[o];return!e.some(function(d){return!(d&&typeof d.getBoundingClientRect=="function")})}function wn(l){l===void 0&&(l={});var e=l,o=e.defaultModifiers,d=o===void 0?[]:o,h=e.defaultOptions,f=h===void 0?Ki:h;return function(v,P,k){k===void 0&&(k=f);var V,B,S={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ki,f),modifiersData:{},elements:{reference:v,popper:P},attributes:{},styles:{}},ne=[],U=!1,z={state:S,setOptions:function(X){var be=typeof X=="function"?X(S.options):X;K(),S.options=Object.assign({},f,S.options,be),S.scrollParents={reference:Et(v)?Jt(v):v.contextElement?Jt(v.contextElement):[],popper:Jt(P)};var Pe,re,fe=function(ie){var ae=xo(ie);return Ii.reduce(function(ve,ye){return ve.concat(ae.filter(function(we){return we.phase===ye}))},[])}((Pe=[].concat(d,S.options.modifiers),re=Pe.reduce(function(ie,ae){var ve=ie[ae.name];return ie[ae.name]=ve?Object.assign({},ve,ae,{options:Object.assign({},ve.options,ae.options),data:Object.assign({},ve.data,ae.data)}):ae,ie},{}),Object.keys(re).map(function(ie){return re[ie]})));return S.orderedModifiers=fe.filter(function(ie){return ie.enabled}),S.orderedModifiers.forEach(function(ie){var ae=ie.name,ve=ie.options,ye=ve===void 0?{}:ve,we=ie.effect;if(typeof we=="function"){var Te=we({state:S,name:ae,instance:z,options:ye});ne.push(Te||function(){})}}),z.update()},forceUpdate:function(){if(!U){var X=S.elements,be=X.reference,Pe=X.popper;if(Gi(be,Pe)){S.rects={reference:Po(be,zt(Pe),S.options.strategy==="fixed"),popper:Gn(Pe)},S.reset=!1,S.placement=S.options.placement,S.orderedModifiers.forEach(function(we){return S.modifiersData[we.name]=Object.assign({},we.data)});for(var re=0;re<S.orderedModifiers.length;re++)if(S.reset!==!0){var fe=S.orderedModifiers[re],ie=fe.fn,ae=fe.options,ve=ae===void 0?{}:ae,ye=fe.name;typeof ie=="function"&&(S=ie({state:S,options:ve,name:ye,instance:z})||S)}else S.reset=!1,re=-1}}},update:(V=function(){return new Promise(function(X){z.forceUpdate(),X(S)})},function(){return B||(B=new Promise(function(X){Promise.resolve().then(function(){B=void 0,X(V())})})),B}),destroy:function(){K(),U=!0}};if(!Gi(v,P))return z;function K(){ne.forEach(function(X){return X()}),ne=[]}return z.setOptions(k).then(function(X){!U&&k.onFirstUpdate&&k.onFirstUpdate(X)}),z}}var Ao=wn(),Co=wn({defaultModifiers:[Xn,ni,zn,Qn]}),ii=wn({defaultModifiers:[Xn,ni,zn,Qn,Wi,Fi,Qi,Oi,Hi]});const Yi=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:wn,detectOverflow:Ht,createPopperBase:Ao,createPopper:ii,createPopperLite:Co,top:qe,bottom:Qe,right:Ke,left:$e,auto:fn,basePlacements:Rt,start:Tt,end:qt,clippingParents:wi,viewport:jn,popper:$t,reference:bi,variationPlacements:Un,placements:Hn,beforeRead:yi,read:_i,afterRead:Pi,beforeMain:xi,main:Ai,afterMain:Ci,beforeWrite:ki,write:Ti,afterWrite:Ei,modifierPhases:Ii,applyStyles:Qn,arrow:Oi,computeStyles:zn,eventListeners:Xn,flip:Fi,hide:Hi,offset:Wi,popperOffsets:ni,preventOverflow:Qi},Symbol.toStringTag,{value:"Module"})),zi="dropdown",ko="ArrowUp",Xi="ArrowDown",Ji="click.bs.dropdown.data-api",Zi="keydown.bs.dropdown.data-api",Zt="show",St='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',To=`${St}.show`,bn=".dropdown-menu",Eo=L()?"top-end":"top-start",Io=L()?"top-start":"top-end",So=L()?"bottom-end":"bottom-start",Vo=L()?"bottom-start":"bottom-end",Mo=L()?"left-start":"right-start",Bo=L()?"right-start":"left-start",Lo={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Oo={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class nt extends Oe{constructor(e,o){super(e,o),this._popper=null,this._parent=this._element.parentNode,this._menu=J.next(this._element,bn)[0]||J.prev(this._element,bn)[0]||J.findOne(bn,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Lo}static get DefaultType(){return Oo}static get NAME(){return zi}toggle(){return this._isShown()?this.hide():this.show()}show(){if(w(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!g.trigger(this._element,"show.bs.dropdown",e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const o of[].concat(...document.body.children))g.on(o,"mouseover",D);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Zt),this._element.classList.add(Zt),g.trigger(this._element,"shown.bs.dropdown",e)}}hide(){if(w(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!g.trigger(this._element,"hide.bs.dropdown",e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))g.off(o,"mouseover",D);this._popper&&this._popper.destroy(),this._menu.classList.remove(Zt),this._element.classList.remove(Zt),this._element.setAttribute("aria-expanded","false"),me.removeDataAttribute(this._menu,"popper"),g.trigger(this._element,"hidden.bs.dropdown",e)}}_getConfig(e){if(typeof(e=super._getConfig(e)).reference=="object"&&!c(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${zi.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(Yi===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:c(this._config.reference)?e=u(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const o=this._getPopperConfig();this._popper=ii(e,this._menu,o)}_isShown(){return this._menu.classList.contains(Zt)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return Mo;if(e.classList.contains("dropstart"))return Bo;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const o=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains("dropup")?o?Io:Eo:o?Vo:So}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(o=>Number.parseInt(o,10)):typeof e=="function"?o=>e(o,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(me.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...typeof this._config.popperConfig=="function"?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:o}){const d=J.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(h=>b(h));d.length&&O(d,o,e===Xi,!d.includes(o)).focus()}static jQueryInterface(e){return this.each(function(){const o=nt.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0)throw new TypeError(`No method named "${e}"`);o[e]()}})}static clearMenus(e){if(e.button===2||e.type==="keyup"&&e.key!=="Tab")return;const o=J.find(To);for(const d of o){const h=nt.getInstance(d);if(!h||h._config.autoClose===!1)continue;const f=e.composedPath(),v=f.includes(h._menu);if(f.includes(h._element)||h._config.autoClose==="inside"&&!v||h._config.autoClose==="outside"&&v||h._menu.contains(e.target)&&(e.type==="keyup"&&e.key==="Tab"||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const P={relatedTarget:h._element};e.type==="click"&&(P.clickEvent=e),h._completeHide(P)}}static dataApiKeydownHandler(e){const o=/input|textarea/i.test(e.target.tagName),d=e.key==="Escape",h=[ko,Xi].includes(e.key);if(!h&&!d||o&&!d)return;e.preventDefault();const f=this.matches(St)?this:J.prev(this,St)[0]||J.next(this,St)[0]||J.findOne(St,e.delegateTarget.parentNode),v=nt.getOrCreateInstance(f);if(h)return e.stopPropagation(),v.show(),void v._selectMenuItem(e);v._isShown()&&(e.stopPropagation(),v.hide(),f.focus())}}g.on(document,Zi,St,nt.dataApiKeydownHandler),g.on(document,Zi,bn,nt.dataApiKeydownHandler),g.on(document,Ji,nt.clearMenus),g.on(document,"keyup.bs.dropdown.data-api",nt.clearMenus),g.on(document,Ji,St,function(l){l.preventDefault(),nt.getOrCreateInstance(this).toggle()}),M(nt);const es=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",ts=".sticky-top",yn="padding-right",ns="margin-right";class si{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,yn,o=>o+e),this._setElementAttributes(es,yn,o=>o+e),this._setElementAttributes(ts,ns,o=>o-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,yn),this._resetElementAttributes(es,yn),this._resetElementAttributes(ts,ns)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,o,d){const h=this.getWidth();this._applyManipulationCallback(e,f=>{if(f!==this._element&&window.innerWidth>f.clientWidth+h)return;this._saveInitialAttribute(f,o);const v=window.getComputedStyle(f).getPropertyValue(o);f.style.setProperty(o,`${d(Number.parseFloat(v))}px`)})}_saveInitialAttribute(e,o){const d=e.style.getPropertyValue(o);d&&me.setDataAttribute(e,o,d)}_resetElementAttributes(e,o){this._applyManipulationCallback(e,d=>{const h=me.getDataAttribute(d,o);h!==null?(me.removeDataAttribute(d,o),d.style.setProperty(o,h)):d.style.removeProperty(o)})}_applyManipulationCallback(e,o){if(c(e))o(e);else for(const d of J.find(e,this._element))o(d)}}const is="show",ss="mousedown.bs.backdrop",No={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Do={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class os extends Le{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return No}static get DefaultType(){return Do}static get NAME(){return"backdrop"}show(e){if(!this._config.isVisible)return void N(e);this._append();const o=this._getElement();this._config.isAnimated&&x(o),o.classList.add(is),this._emulateAnimation(()=>{N(e)})}hide(e){this._config.isVisible?(this._getElement().classList.remove(is),this._emulateAnimation(()=>{this.dispose(),N(e)})):N(e)}dispose(){this._isAppended&&(g.off(this._element,ss),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=u(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),g.on(e,ss,()=>{N(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){F(e,this._getElement(),this._config.isAnimated)}}const rs=".bs.focustrap",ls="backward",Ro={autofocus:!0,trapElement:null},qo={autofocus:"boolean",trapElement:"element"};class as extends Le{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ro}static get DefaultType(){return qo}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),g.off(document,rs),g.on(document,"focusin.bs.focustrap",e=>this._handleFocusin(e)),g.on(document,"keydown.tab.bs.focustrap",e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,g.off(document,rs))}_handleFocusin(e){const{trapElement:o}=this._config;if(e.target===document||e.target===o||o.contains(e.target))return;const d=J.focusableChildren(o);d.length===0?o.focus():this._lastTabNavDirection===ls?d[d.length-1].focus():d[0].focus()}_handleKeydown(e){e.key==="Tab"&&(this._lastTabNavDirection=e.shiftKey?ls:"forward")}}const cs="hidden.bs.modal",ds="show.bs.modal",us="modal-open",hs="show",oi="modal-static",$o={backdrop:!0,focus:!0,keyboard:!0},Fo={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Vt extends Oe{constructor(e,o){super(e,o),this._dialog=J.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new si,this._addEventListeners()}static get Default(){return $o}static get DefaultType(){return Fo}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||g.trigger(this._element,ds,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(us),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){this._isShown&&!this._isTransitioning&&(g.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(hs),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){for(const e of[window,this._dialog])g.off(e,".bs.modal");this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new os({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new as({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const o=J.findOne(".modal-body",this._dialog);o&&(o.scrollTop=0),x(this._element),this._element.classList.add(hs),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,g.trigger(this._element,"shown.bs.modal",{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){g.on(this._element,"keydown.dismiss.bs.modal",e=>{if(e.key==="Escape")return this._config.keyboard?(e.preventDefault(),void this.hide()):void this._triggerBackdropTransition()}),g.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),g.on(this._element,"mousedown.dismiss.bs.modal",e=>{g.one(this._element,"click.dismiss.bs.modal",o=>{this._element===e.target&&this._element===o.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(us),this._resetAdjustments(),this._scrollBar.reset(),g.trigger(this._element,cs)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(g.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(oi)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(oi),this._queueCallback(()=>{this._element.classList.remove(oi),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,o=this._scrollBar.getWidth(),d=o>0;if(d&&!e){const h=L()?"paddingLeft":"paddingRight";this._element.style[h]=`${o}px`}if(!d&&e){const h=L()?"paddingRight":"paddingLeft";this._element.style[h]=`${o}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,o){return this.each(function(){const d=Vt.getOrCreateInstance(this,e);if(typeof e=="string"){if(d[e]===void 0)throw new TypeError(`No method named "${e}"`);d[e](o)}})}}g.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(l){const e=i(this);["A","AREA"].includes(this.tagName)&&l.preventDefault(),g.one(e,ds,d=>{d.defaultPrevented||g.one(e,cs,()=>{b(this)&&this.focus()})});const o=J.findOne(".modal.show");o&&Vt.getInstance(o).hide(),Vt.getOrCreateInstance(e).toggle(this)}),ut(Vt),M(Vt);const fs="show",ps="showing",gs="hiding",ms=".offcanvas.show",vs="hidePrevented.bs.offcanvas",ws="hidden.bs.offcanvas",jo={backdrop:!0,keyboard:!0,scroll:!1},Uo={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class vt extends Oe{constructor(e,o){super(e,o),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return jo}static get DefaultType(){return Uo}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||g.trigger(this._element,"show.bs.offcanvas",{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new si().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ps),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(fs),this._element.classList.remove(ps),g.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:e})},this._element,!0))}hide(){this._isShown&&(g.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(gs),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(fs,gs),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new si().reset(),g.trigger(this._element,ws)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new os({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{this._config.backdrop!=="static"?this.hide():g.trigger(this._element,vs)}:null})}_initializeFocusTrap(){return new as({trapElement:this._element})}_addEventListeners(){g.on(this._element,"keydown.dismiss.bs.offcanvas",e=>{e.key==="Escape"&&(this._config.keyboard?this.hide():g.trigger(this._element,vs))})}static jQueryInterface(e){return this.each(function(){const o=vt.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);o[e](this)}})}}g.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(l){const e=i(this);if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),w(this))return;g.one(e,ws,()=>{b(this)&&this.focus()});const o=J.findOne(ms);o&&o!==e&&vt.getInstance(o).hide(),vt.getOrCreateInstance(e).toggle(this)}),g.on(window,"load.bs.offcanvas.data-api",()=>{for(const l of J.find(ms))vt.getOrCreateInstance(l).show()}),g.on(window,"resize.bs.offcanvas",()=>{for(const l of J.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(l).position!=="fixed"&&vt.getOrCreateInstance(l).hide()}),ut(vt),M(vt);const Ho=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Wo=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Qo=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Ko=(l,e)=>{const o=l.nodeName.toLowerCase();return e.includes(o)?!Ho.has(o)||Boolean(Wo.test(l.nodeValue)||Qo.test(l.nodeValue)):e.filter(d=>d instanceof RegExp).some(d=>d.test(o))},bs={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Go={allowList:bs,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Yo={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},zo={entry:"(string|element|function|null)",selector:"(string|element)"};class Xo extends Le{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Go}static get DefaultType(){return Yo}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[h,f]of Object.entries(this._config.content))this._setContent(e,f,h);const o=e.children[0],d=this._resolvePossibleFunction(this._config.extraClass);return d&&o.classList.add(...d.split(" ")),o}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[o,d]of Object.entries(e))super._typeCheckConfig({selector:o,entry:d},zo)}_setContent(e,o,d){const h=J.findOne(d,e);h&&((o=this._resolvePossibleFunction(o))?c(o)?this._putElementInTemplate(u(o),h):this._config.html?h.innerHTML=this._maybeSanitize(o):h.textContent=o:h.remove())}_maybeSanitize(e){return this._config.sanitize?function(o,d,h){if(!o.length)return o;if(h&&typeof h=="function")return h(o);const f=new window.DOMParser().parseFromString(o,"text/html"),v=[].concat(...f.body.querySelectorAll("*"));for(const P of v){const k=P.nodeName.toLowerCase();if(!Object.keys(d).includes(k)){P.remove();continue}const V=[].concat(...P.attributes),B=[].concat(d["*"]||[],d[k]||[]);for(const S of V)Ko(S,B)||P.removeAttribute(S.nodeName)}return f.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return typeof e=="function"?e(this):e}_putElementInTemplate(e,o){if(this._config.html)return o.innerHTML="",void o.append(e);o.textContent=e.textContent}}const Jo=new Set(["sanitize","allowList","sanitizeFn"]),ri="fade",_n="show",ys=".modal",_s="hide.bs.modal",Pn="hover",Ps="focus",Zo={AUTO:"auto",TOP:"top",RIGHT:L()?"left":"right",BOTTOM:"bottom",LEFT:L()?"right":"left"},er={allowList:bs,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},tr={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Mt extends Oe{constructor(e,o){if(Yi===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,o),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return er}static get DefaultType(){return tr}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),g.off(this._element.closest(ys),_s,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=g.trigger(this._element,this.constructor.eventName("show")),o=(j(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const d=this._getTipElement();this._element.setAttribute("aria-describedby",d.getAttribute("id"));const{container:h}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(h.append(d),g.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(d),d.classList.add(_n),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))g.on(f,"mouseover",D);this._queueCallback(()=>{g.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!g.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(_n),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))g.off(e,"mouseover",D);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),g.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const o=this._getTemplateFactory(e).toHtml();if(!o)return null;o.classList.remove(ri,_n),o.classList.add(`bs-${this.constructor.NAME}-auto`);const d=(h=>{do h+=Math.floor(1e6*Math.random());while(document.getElementById(h));return h})(this.constructor.NAME).toString();return o.setAttribute("id",d),this._isAnimated()&&o.classList.add(ri),o}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Xo({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ri)}_isShown(){return this.tip&&this.tip.classList.contains(_n)}_createPopper(e){const o=typeof this._config.placement=="function"?this._config.placement.call(this,e,this._element):this._config.placement,d=Zo[o.toUpperCase()];return ii(this._element,e,this._getPopperConfig(d))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(o=>Number.parseInt(o,10)):typeof e=="function"?o=>e(o,this._element):e}_resolvePossibleFunction(e){return typeof e=="function"?e.call(this._element):e}_getPopperConfig(e){const o={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:d=>{this._getTipElement().setAttribute("data-popper-placement",d.state.placement)}}]};return{...o,...typeof this._config.popperConfig=="function"?this._config.popperConfig(o):this._config.popperConfig}}_setListeners(){const e=this._config.trigger.split(" ");for(const o of e)if(o==="click")g.on(this._element,this.constructor.eventName("click"),this._config.selector,d=>{this._initializeOnDelegatedTarget(d).toggle()});else if(o!=="manual"){const d=o===Pn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),h=o===Pn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");g.on(this._element,d,this._config.selector,f=>{const v=this._initializeOnDelegatedTarget(f);v._activeTrigger[f.type==="focusin"?Ps:Pn]=!0,v._enter()}),g.on(this._element,h,this._config.selector,f=>{const v=this._initializeOnDelegatedTarget(f);v._activeTrigger[f.type==="focusout"?Ps:Pn]=v._element.contains(f.relatedTarget),v._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},g.on(this._element.closest(ys),_s,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,o){clearTimeout(this._timeout),this._timeout=setTimeout(e,o)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const o=me.getDataAttributes(this._element);for(const d of Object.keys(o))Jo.has(d)&&delete o[d];return e={...o,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:u(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const o in this._config)this.constructor.Default[o]!==this._config[o]&&(e[o]=this._config[o]);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const o=Mt.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0)throw new TypeError(`No method named "${e}"`);o[e]()}})}}M(Mt);const nr={...Mt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ir={...Mt.DefaultType,content:"(null|string|element|function)"};class xn extends Mt{static get Default(){return nr}static get DefaultType(){return ir}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const o=xn.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0)throw new TypeError(`No method named "${e}"`);o[e]()}})}}M(xn);const xs="click.bs.scrollspy",en="active",As="[href]",sr={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},or={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class tn extends Oe{constructor(e,o){super(e,o),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return sr}static get DefaultType(){return or}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=u(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(o=>Number.parseFloat(o))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(g.off(this._config.target,xs),g.on(this._config.target,xs,As,e=>{const o=this._observableSections.get(e.target.hash);if(o){e.preventDefault();const d=this._rootElement||window,h=o.offsetTop-this._element.offsetTop;if(d.scrollTo)return void d.scrollTo({top:h,behavior:"smooth"});d.scrollTop=h}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(o=>this._observerCallback(o),e)}_observerCallback(e){const o=v=>this._targetLinks.get(`#${v.target.id}`),d=v=>{this._previousScrollData.visibleEntryTop=v.target.offsetTop,this._process(o(v))},h=(this._rootElement||document.documentElement).scrollTop,f=h>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=h;for(const v of e){if(!v.isIntersecting){this._activeTarget=null,this._clearActiveClass(o(v));continue}const P=v.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(f&&P){if(d(v),!h)return}else f||P||d(v)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=J.find(As,this._config.target);for(const o of e){if(!o.hash||w(o))continue;const d=J.findOne(o.hash,this._element);b(d)&&(this._targetLinks.set(o.hash,o),this._observableSections.set(o.hash,d))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(en),this._activateParents(e),g.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))J.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(en);else for(const o of J.parents(e,".nav, .list-group"))for(const d of J.prev(o,".nav-link, .nav-item > .nav-link, .list-group-item"))d.classList.add(en)}_clearActiveClass(e){e.classList.remove(en);const o=J.find("[href].active",e);for(const d of o)d.classList.remove(en)}static jQueryInterface(e){return this.each(function(){const o=tn.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);o[e]()}})}}g.on(window,"load.bs.scrollspy.data-api",()=>{for(const l of J.find('[data-bs-spy="scroll"]'))tn.getOrCreateInstance(l)}),M(tn);const rr="ArrowLeft",Cs="ArrowRight",lr="ArrowUp",ks="ArrowDown",An="active",Ts="fade",li="show",Es='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',ai=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${Es}`;class Bt extends Oe{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),g.on(this._element,"keydown.bs.tab",o=>this._keydown(o)))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const o=this._getActiveElem(),d=o?g.trigger(o,"hide.bs.tab",{relatedTarget:e}):null;g.trigger(e,"show.bs.tab",{relatedTarget:o}).defaultPrevented||d&&d.defaultPrevented||(this._deactivate(o,e),this._activate(e,o))}_activate(e,o){e&&(e.classList.add(An),this._activate(i(e)),this._queueCallback(()=>{e.getAttribute("role")==="tab"?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),g.trigger(e,"shown.bs.tab",{relatedTarget:o})):e.classList.add(li)},e,e.classList.contains(Ts)))}_deactivate(e,o){e&&(e.classList.remove(An),e.blur(),this._deactivate(i(e)),this._queueCallback(()=>{e.getAttribute("role")==="tab"?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),g.trigger(e,"hidden.bs.tab",{relatedTarget:o})):e.classList.remove(li)},e,e.classList.contains(Ts)))}_keydown(e){if(![rr,Cs,lr,ks].includes(e.key))return;e.stopPropagation(),e.preventDefault();const o=[Cs,ks].includes(e.key),d=O(this._getChildren().filter(h=>!w(h)),e.target,o,!0);d&&(d.focus({preventScroll:!0}),Bt.getOrCreateInstance(d).show())}_getChildren(){return J.find(ai,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,o){this._setAttributeIfNotExists(e,"role","tablist");for(const d of o)this._setInitialAttributesOnChild(d)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const o=this._elemIsActive(e),d=this._getOuterElement(e);e.setAttribute("aria-selected",o),d!==e&&this._setAttributeIfNotExists(d,"role","presentation"),o||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const o=i(e);o&&(this._setAttributeIfNotExists(o,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(o,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,o){const d=this._getOuterElement(e);if(!d.classList.contains("dropdown"))return;const h=(f,v)=>{const P=J.findOne(f,d);P&&P.classList.toggle(v,o)};h(".dropdown-toggle",An),h(".dropdown-menu",li),d.setAttribute("aria-expanded",o)}_setAttributeIfNotExists(e,o,d){e.hasAttribute(o)||e.setAttribute(o,d)}_elemIsActive(e){return e.classList.contains(An)}_getInnerElement(e){return e.matches(ai)?e:J.findOne(ai,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(e){return this.each(function(){const o=Bt.getOrCreateInstance(this);if(typeof e=="string"){if(o[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);o[e]()}})}}g.on(document,"click.bs.tab",Es,function(l){["A","AREA"].includes(this.tagName)&&l.preventDefault(),w(this)||Bt.getOrCreateInstance(this).show()}),g.on(window,"load.bs.tab",()=>{for(const l of J.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))Bt.getOrCreateInstance(l)}),M(Bt);const Is="hide",Cn="show",kn="showing",ar={animation:"boolean",autohide:"boolean",delay:"number"},cr={animation:!0,autohide:!0,delay:5e3};class nn extends Oe{constructor(e,o){super(e,o),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return cr}static get DefaultType(){return ar}static get NAME(){return"toast"}show(){g.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Is),x(this._element),this._element.classList.add(Cn,kn),this._queueCallback(()=>{this._element.classList.remove(kn),g.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(g.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(kn),this._queueCallback(()=>{this._element.classList.add(Is),this._element.classList.remove(kn,Cn),g.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Cn),super.dispose()}isShown(){return this._element.classList.contains(Cn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,o){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=o;break;case"focusin":case"focusout":this._hasKeyboardInteraction=o}if(o)return void this._clearTimeout();const d=e.relatedTarget;this._element===d||this._element.contains(d)||this._maybeScheduleHide()}_setListeners(){g.on(this._element,"mouseover.bs.toast",e=>this._onInteraction(e,!0)),g.on(this._element,"mouseout.bs.toast",e=>this._onInteraction(e,!1)),g.on(this._element,"focusin.bs.toast",e=>this._onInteraction(e,!0)),g.on(this._element,"focusout.bs.toast",e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const o=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(o[e]===void 0)throw new TypeError(`No method named "${e}"`);o[e](this)}})}}return ut(nn),M(nn),{Alert:st,Button:bt,Carousel:ze,Collapse:Dt,Dropdown:nt,Modal:Vt,Offcanvas:vt,Popover:xn,ScrollSpy:tn,Tab:Bt,Toast:nn,Tooltip:Mt}})})(Dr);const Kt="b",Gt="k",hi="n",Qs="p",Yt="q";class T{x;y;state=!0;constructor(n,t){this.x=n,this.y=t}}class y{start;end;boardStartIndex;boardEndIndex;constructor(n,t,s,r){if(s&&(this.start=s),r&&(this.end=r),s&&r){this.boardStartIndex=this.convertToBoardIndex(s),this.boardEndIndex=this.convertToBoardIndex(r);return}n&&t?(this.boardStartIndex=n.x+n.y*8,this.boardEndIndex=t.x+t.y*8,this.start=this.convertToBoardPosition(this.boardStartIndex),this.end=this.convertToBoardPosition(this.boardEndIndex)):(this.start="a8",this.end="a8",this.boardStartIndex=0,this.boardEndIndex=0)}toString(){return this.start+"-"+this.end}convertToBoardIndex(n){if(n.length!=2)throw new Error("Invalid position");let t=n[0],s=n[1],r=t.charCodeAt(0)-97,i=8-parseInt(s);return r+i*8}convertToBoardPosition(n){if(n<0||n>63)throw new Error("Invalid index: "+n);let t=n%8,s=Math.floor(n/8),r=String.fromCharCode(t+97),i=8-s;return r+i}testConverToBoardIndex(){let n=[];n.push(this.convertToBoardIndex("a8")==0),n.push(this.convertToBoardIndex("b8")==1),n.push(this.convertToBoardIndex("c8")==2),n.push(this.convertToBoardIndex("d8")==3),n.push(this.convertToBoardIndex("e8")==4),n.push(this.convertToBoardIndex("f8")==5),n.push(this.convertToBoardIndex("g8")==6),n.push(this.convertToBoardIndex("h8")==7),n.push(this.convertToBoardIndex("a7")==8),n.push(this.convertToBoardIndex("b7")==9),n.push(this.convertToBoardIndex("c7")==10),n.push(this.convertToBoardIndex("d7")==11),n.push(this.convertToBoardIndex("e7")==12),n.push(this.convertToBoardIndex("f7")==13),n.push(this.convertToBoardIndex("g7")==14),n.push(this.convertToBoardIndex("h7")==15),n.push(this.convertToBoardIndex("a6")==16);for(let t=0;t<n.length;t++)if(!n[t])throw new Error("Convert to board Index failed failed")}runAllTests(){this.testConverToBoardIndex(),console.log("All tests ran for move class")}}class xt{position;pos;boardIndex;constructor(n,t){n?(this.position=n,this.boardIndex=this.convertToBoardIndex(n),this.pos=new T(this.convertToBoardIndex(n)%8,Math.floor(this.convertToBoardIndex(n)/8))):t?(this.boardIndex=t,this.position=this.convertToBoardPosition(t),this.pos=new T(t%8,Math.floor(t/8))):(this.position="a8",this.boardIndex=0,this.pos=new T(0,0))}moveTo(n){this.position=n,this.boardIndex=this.convertToBoardIndex(n),this.pos=new T(this.boardIndex%8,Math.floor(this.boardIndex/8))}getPosition(){return this.position}getIndex(){return this.boardIndex}convertToBoardIndex(n){if(n.length!=2)throw new Error("Invalid position");let t=n[0],s=n[1],r=t.charCodeAt(0)-97,i=8-parseInt(s);return r+i*8}testConvertToBoardIndex(){let n=[];n.push(this.convertToBoardIndex("a8")==0),n.push(this.convertToBoardIndex("b8")==1),n.push(this.convertToBoardIndex("c8")==2),n.push(this.convertToBoardIndex("d8")==3),n.push(this.convertToBoardIndex("e8")==4),n.push(this.convertToBoardIndex("f8")==5),n.push(this.convertToBoardIndex("g8")==6),n.push(this.convertToBoardIndex("h8")==7),n.push(this.convertToBoardIndex("a7")==8),n.push(this.convertToBoardIndex("b7")==9),n.push(this.convertToBoardIndex("c7")==10),n.push(this.convertToBoardIndex("d7")==11),n.push(this.convertToBoardIndex("e7")==12),n.push(this.convertToBoardIndex("f7")==13),n.push(this.convertToBoardIndex("g7")==14),n.push(this.convertToBoardIndex("h7")==15),n.push(this.convertToBoardIndex("a6")==16);for(let t=0;t<n.length;t++)if(!n[t])throw new Error("Convert to board Index failed failed")}convertToBoardPosition(n){let t=n%8,s=Math.floor(n/8),r=String.fromCharCode(t+97),i=8-s;return r+i}testConvertToPosition(){let n=[];n.push(this.convertToBoardPosition(0)=="a8"),n.push(this.convertToBoardPosition(0)=="a8"),n.push(this.convertToBoardPosition(0)=="a8"),n.push(this.convertToBoardPosition(1)=="b8"),n.push(this.convertToBoardPosition(2)=="c8"),n.push(this.convertToBoardPosition(3)=="d8"),n.push(this.convertToBoardPosition(4)=="e8"),n.push(this.convertToBoardPosition(5)=="f8"),n.push(this.convertToBoardPosition(6)=="g8"),n.push(this.convertToBoardPosition(7)=="h8"),n.push(this.convertToBoardPosition(8)=="a7"),n.push(this.convertToBoardPosition(9)=="b7"),n.push(this.convertToBoardPosition(10)=="c7"),n.push(this.convertToBoardPosition(11)=="d7"),n.push(this.convertToBoardPosition(12)=="e7"),n.push(this.convertToBoardPosition(13)=="f7"),n.push(this.convertToBoardPosition(14)=="g7"),n.push(this.convertToBoardPosition(15)=="h7"),n.push(this.convertToBoardPosition(16)=="a6");for(let t=0;t<n.length;t++)if(!n[t])throw new Error("Convert to position failed")}runAllTests(){this.testConvertToBoardIndex(),this.testConvertToPosition(),console.log("All tests ran for position class")}}class xe{position;color;type;constructor(n,t,s){this.position=new xt(n),this.color=t,this.type=s}move(n){this.position.moveTo(n)}getPosition(){return this.position.getPosition()}getIndex(){return this.position.getIndex()}getPos(){return this.position}convertToBoardIndex(n){if(n.length!=2)throw new Error("Invalid position");let t=n[0],s=n[1],r=t.charCodeAt(0)-97,i=8-parseInt(s);return r+i*8}testConverToBoardIndex(){let n=[];n.push(this.convertToBoardIndex("a8")==0),n.push(this.convertToBoardIndex("b8")==1),n.push(this.convertToBoardIndex("c8")==2),n.push(this.convertToBoardIndex("d8")==3),n.push(this.convertToBoardIndex("e8")==4),n.push(this.convertToBoardIndex("f8")==5),n.push(this.convertToBoardIndex("g8")==6),n.push(this.convertToBoardIndex("h8")==7),n.push(this.convertToBoardIndex("a7")==8),n.push(this.convertToBoardIndex("b7")==9),n.push(this.convertToBoardIndex("c7")==10),n.push(this.convertToBoardIndex("d7")==11),n.push(this.convertToBoardIndex("e7")==12),n.push(this.convertToBoardIndex("f7")==13),n.push(this.convertToBoardIndex("g7")==14),n.push(this.convertToBoardIndex("h7")==15),n.push(this.convertToBoardIndex("a6")==16);for(let t=0;t<n.length;t++)if(!n[t])throw new Error("Convert to board Index failed failed")}runAllTests(){this.testConverToBoardIndex(),console.log("All tests ran for piece class")}}class ce{Pieces;currentTurnColor="white";fen="";board=[];halfMoveClock=0;fullMoveNumber=1;castlingRights="KQkq";enPassantTargetSquare="-";legalMoves=[];inCheck=!1;checkMate=!1;capturedPieces=[];constructor(n,t){n||(n=["r","n","b","q","k","b","n","r","p","p","p","p","p","p","p","p"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","P","P","P","P","P","P","P","P","R","N","B","Q","K","B","N","R"]);const s=/^([rnbqkpRNBQKP1-8]+\/){7}([rnbqkpRNBQKP1-8]+)\s[bw]\s(-|K?Q?k?q?)\s(-|[a-h][36])\s(0|[1-9][0-9]*)\s([1-9][0-9]*)/;if(t!=null&&t.match(s)){let r=t.split(" ");n=this.fenToBoard(t),this.castlingRights=r[2],this.enPassantTargetSquare=r[3],r[1]==="w"?this.currentTurnColor="white":this.currentTurnColor="black",this.halfMoveClock=parseInt(r[4]),this.fullMoveNumber=parseInt(r[5])}else if(t!=null&&!t.match(s))throw new Error("Invalid fen: "+t);this.Pieces=[];for(let r=0;r<n.length;r++){let i=n[r];if(i!=" "){let p=i==i.toUpperCase()?"white":"black",c=i.toLowerCase(),u=this.convertToPosition(r);this.Pieces.push(new xe(u,p,c))}}this.board=n,t!=null?this.fen=t:this.fen=this.boardToFen()}convertToPosition(n){let t=String.fromCharCode(97+n%8),s=8-Math.floor(n/8);return t+s}displayBoard(){let n="";for(let t=0;t<8;t++){for(let s=0;s<8;s++)n+=this.Piece(new T(s,t))===" "?" - ":" "+(this.Piece(new T(s,t)).color==="black"?this.Piece(new T(s,t)).type:this.Piece(new T(s,t)).type.toUpperCase())+" ";n!=null&&console.log(`${8-t}| `+n),n=""}console.log("    _  _  _  _  _  _  _  _"),console.log("    A  B  C  D  E  F  G  H")}fenToBoard(n){let t=[],i=n.split(" ")[0].split("/");for(let p=0;p<i.length;p++){let u=i[p].split("");for(let b=0;b<u.length;b++){let w=u[b];if(w.match(/[1-8]/))for(let j=0;j<parseInt(w);j++)t.push(" ");else t.push(w)}}return t.length===63&&t.push(" "),t}boardToFen(){let n="",t=0;for(let s=0;s<64;s++){let r=this.getPieceAtBoardIndex(s);r===""?(t++,(t===8||s%8===7)&&(n+=t,s!=63&&(n+="/"),t=0)):(t!==0&&(n+=t,t=0),n+=r.color==="white"?r.type.toUpperCase():r.type.toLowerCase(),r.getIndex()%8===7&&s!==63&&(n+="/",t=0))}return n+=" "+this.currentTurnColor[0]+" ",n+=this.castlingRights+" ",n+=this.enPassantTargetSquare+" ",n+=this.halfMoveClock+" ",n+=this.fullMoveNumber,n}getPieceAtBoardIndex(n){for(let t=0;t<this.Pieces.length;t++)if(this.Pieces[t].getIndex()===n)return this.Pieces[t];return""}movePiece(n,t){let s=new y(void 0,void 0,n,t);s.boardEndIndex;let r=this.getPieceIndex(n),i=this.Pieces[r];if(i?.type===void 0)throw this.displayBoard(),console.log(this.Pieces),console.log(this.fen),console.log(n),new Error("Invalid move");if(i.type!="p"?this.halfMoveClock++:this.halfMoveClock=0,this.enPassantTargetSquare!="-"&&i.type==="p"){let p=new xt(n),c=new xt(t);if(i.color==="white"&&p.pos.y===3&&c.position===t){let u=c.boardIndex+8,b=this.getPieceAtBoardIndex(u);this.board[u]=" ",this.Pieces.splice(this.Pieces.indexOf(b),1)}if(i.color==="black"&&p.pos.y===4&&c.position===t){let u=c.boardIndex-8,b=this.getPieceAtBoardIndex(u);this.board[u]=" ",this.Pieces.splice(this.Pieces.indexOf(b),1)}}if(i.type=="p"&&Math.abs(i.getIndex()-s.boardEndIndex)==16){let p="-";i.color==="white"?p=this.convertToPosition(s.boardEndIndex+8):p=this.convertToPosition(s.boardEndIndex-8),this.enPassantTargetSquare=p}else this.enPassantTargetSquare="-";if(i.type==="k"){if(i.color==="white"){let p=new xt(n),c=new xt(t);if(p.pos.x-c.pos.x===2&&this.castlingRights.includes("Q")){this.convertToPosition(p.boardIndex-4);let u=this.convertToPosition(p.boardIndex-1),b=this.getPieceAtBoardIndex(p.boardIndex-4);this.castlingRights=this.castlingRights.replace("KQ",""),b.color!=null&&b.move(u)}if(p.pos.x-c.pos.x===-2&&this.castlingRights.includes("K")){this.convertToPosition(p.boardIndex+3);let u=this.convertToPosition(p.boardIndex+1),b=this.getPieceAtBoardIndex(p.boardIndex+3);console.log(u),console.log(b),this.castlingRights=this.castlingRights.replace("KQ",""),b.color!=null&&b.move(u)}this.castlingRights=this.castlingRights.replace("KQ","")}else{let p=new xt(n),c=new xt(t);if(p.pos.x-c.pos.x===2&&this.castlingRights.includes("q")){this.convertToPosition(p.boardIndex-4);let u=this.convertToPosition(p.boardIndex-1),b=this.getPieceAtBoardIndex(p.boardIndex-4);this.castlingRights=this.castlingRights.replace("kq",""),b.color!=null&&b.move(u)}if(p.pos.x-c.pos.x===-2&&this.castlingRights.includes("k")){this.convertToPosition(p.boardIndex+3);let u=this.convertToPosition(p.boardIndex+1),b=this.getPieceAtBoardIndex(p.boardIndex+3);this.castlingRights=this.castlingRights.replace("kq",""),b.color!=null&&b.move(u)}this.castlingRights=this.castlingRights.replace("kq","")}this.castlingRights===""&&(this.castlingRights="-")}if(this.currentTurnColor==="black"&&this.fullMoveNumber++,i.type==="r"&&(i.color==="white"?i.getIndex()===0?this.castlingRights=this.castlingRights.replace("Q",""):i.getIndex()===7&&(this.castlingRights=this.castlingRights.replace("K","")):i.getIndex()===56?this.castlingRights=this.castlingRights.replace("q",""):i.getIndex()===63&&(this.castlingRights=this.castlingRights.replace("k",""))),this.getPieceIndex(t)!==-1){let p=this.getPieceIndex(t),c=this.Pieces[p];c.type==="r"&&(c.color==="white"?c.getIndex()===56?this.castlingRights=this.castlingRights.replace("Q",""):c.getIndex()===63&&(this.castlingRights=this.castlingRights.replace("K","")):c.getIndex()===0?this.castlingRights=this.castlingRights.replace("q",""):c.getIndex()===7&&(this.castlingRights=this.castlingRights.replace("k",""))),this.capturedPieces.push(c),this.Pieces.splice(p,1),this.halfMoveClock=0}i.move(t),this.currentTurnColor=this.currentTurnColor==="white"?"black":"white",this.fen=this.boardToFen(),this.board=this.fenToBoard(this.fen),this.inCheck=this.isInCheck(this)}getPieceIndex(n){let t=-1;for(let s=0;s<this.Pieces.length;s++)if(this.Pieces[s].getPosition()==n){t=s;break}return t}getPieceAtPosition(n){let t="";for(let s=0;s<this.Pieces.length;s++){let r=this.Pieces[s];if(r.getPosition()==n)return r}return t}testConvertToPosition(){let n=[];n.push(this.convertToPosition(0)=="a8"),n.push(this.convertToPosition(1)=="b8"),n.push(this.convertToPosition(2)=="c8"),n.push(this.convertToPosition(3)=="d8"),n.push(this.convertToPosition(4)=="e8"),n.push(this.convertToPosition(5)=="f8"),n.push(this.convertToPosition(6)=="g8"),n.push(this.convertToPosition(7)=="h8"),n.push(this.convertToPosition(8)=="a7"),n.push(this.convertToPosition(9)=="b7"),n.push(this.convertToPosition(10)=="c7"),n.push(this.convertToPosition(11)=="d7"),n.push(this.convertToPosition(12)=="e7"),n.push(this.convertToPosition(13)=="f7"),n.push(this.convertToPosition(14)=="g7"),n.push(this.convertToPosition(15)=="h7"),n.push(this.convertToPosition(16)=="a6");for(let t=0;t<n.length;t++)if(!n[t])throw new Error("Convert to position failed")}testFenToBoard(){let n=[];n.push(this.fenToBoard("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")),n.push(this.fenToBoard("rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1"));for(let s=0;s<n.length;s++)if(!n[s])throw new Error("Fen to board failed");t(n[0],["r","n","b","q","k","b","n","r","p","p","p","p","p","p","p","p"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","P","P","P","P","P","P","P","P","R","N","B","Q","K","B","N","R"]),t(n[1],["r","n","b","q","k","b","n","r","p","p","p","p","p","p","p","p"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","P"," "," "," "," "," "," "," "," "," "," "," ","P","P","P","P"," ","P","P","P","R","N","B","Q","K","B","N","R"]);function t(s,r){if(s===r)return!0;if(s==null||r==null)throw console.log(s,r),new Error("Fen to board failed");if(s.length!==r.length)throw console.log(s,r),new Error("Fen to board failed");for(var i=0;i<s.length;++i)if(s[i]!==r[i])throw console.log(s,r),new Error("Fen to board failed");return!0}}testBoardToFen(){let n=[],t=new ce;n.push(t.boardToFen()=="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),t.movePiece("e2","e4"),n.push(t.boardToFen()=="rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1");for(let s=0;s<n.length;s++)if(!n[s])throw new Error("Board to fen failed, test "+(s+1)+" failed"+t.boardToFen())}testConstructors(){let n=new ce,t=[];t.push(n.Pieces[0]?.getPosition()=="a8"),t.push(n.Pieces[0].color=="black"),t.push(n.Pieces[0].type=="r"),t.push(n.Pieces[1]?.getPosition()=="b8"),t.push(n.Pieces[1].color=="black"),t.push(n.Pieces[1].type=="n"),t.push(n.Pieces[2]?.getPosition()=="c8"),t.push(n.Pieces[2].color=="black"),t.push(n.Pieces[2].type=="b"),t.push(n.Pieces[3]?.getPosition()=="d8");for(let i=0;i<t.length;i++)if(!t[i])throw new Error("Board constructor 1 failed "+i);let s=new ce([],"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");t=[],t.push(s.Pieces[0]?.getPosition()=="a8"),t.push(s.Pieces[0].color=="black"),t.push(s.Pieces[0].type=="r"),t.push(s.Pieces[1]?.getPosition()=="b8"),t.push(s.Pieces[1].color=="black"),t.push(s.Pieces[1].type=="n"),t.push(s.Pieces[2]?.getPosition()=="c8"),t.push(s.Pieces[2].color=="black"),t.push(s.Pieces[2].type=="b"),t.push(s.Pieces[3]?.getPosition()=="d8");for(let i=0;i<t.length;i++)if(!t[i])throw new Error("Board constructor 2 failed"+i);let r=new ce([],"rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1");t=[],t.push(r.Pieces[0]?.getPosition()=="a8"),t.push(r.Pieces[0].color=="black"),t.push(r.Pieces[0].type=="r"),t.push(r.currentTurnColor=="black");for(let i=0;i<t.length;i++)if(!t[i])throw new Error("Board constructor 3 failed"+i)}findPseudoLegalMoves(n){let t=[];for(let s=0;s<n.Pieces.length;s++){let r=n.Pieces[s];if(n.currentTurnColor===r.color)switch(r.type){case"p":t.push(...this.findPawnMoves(r,n));break;case"r":t.push(...this.findRookMoves(r,n));break;case"n":t.push(...this.findKnightMoves(r,n));break;case"b":t.push(...this.findBishopMoves(r,n));break;case"q":t.push(...this.findQueenMoves(r,n));break;case"k":t.push(...this.findKingMoves(r,n));break}}return t}testFindPseudoLegalMoves(){let n=new ce,t=this.findPseudoLegalMoves(n),s=[];s.push(t.length==20);for(let r=0;r<s.length;r++)if(!s[r])throw new Error("Find legal moves failed, test "+(r+1)+" failed");n=new ce([],"rnbqkbnr/1ppp1ppp/8/p3pP2/4P3/8/PPPP2PP/RNBQKBNR w KQkq e6 0 4"),t=this.findPseudoLegalMoves(n),s=[],s.push(t.length==30);for(let r=0;r<s.length;r++)if(!s[r])throw new Error("Find legal moves failed, test "+(r+1)+" failed")}findLegalMoves(n){let t=n.findPseudoLegalMoves(n),s=[];for(let r=0;r<t.length;r++){let i=new ce([],n.boardToFen());i.movePiece(t[r].start,t[r].end),i.currentTurnColor=i.currentTurnColor==="white"?"black":"white",this.isInCheck(i)||s.push(t[r])}return n.legalMoves=s,s}testFindLegalMoves(){let n=new ce,t=this.findLegalMoves(n),s=[];s.push(t.length==20),n=new ce([],"rnb1k1nr/pppp1ppp/8/2b1p3/P3q3/8/1PPP1PPP/RNBQKB1R w KQkq - 0 6"),t=this.findLegalMoves(n),s.push(t.length==2),n=new ce([],"rnbqkbnr/1ppp1ppp/8/p3Q3/4P3/8/PPPP1PPP/RNB1KBNR b KQkq - 0 3"),t=this.findLegalMoves(n),s.push(t.length==3),n=new ce([],"rnbqkbnr/p1p1pppp/1p6/3pP3/8/8/PPPP1PPP/RNBQKBNR w KQkq d6 0 3"),t=this.findLegalMoves(n),s.push(t.length==31);for(let r=0;r<s.length;r++)if(!s[r])throw new Error("Find legal moves failed, test "+(r+1)+" failed")}isInCheck(n){let t=new ce([],n.boardToFen()),s=!0;for(let p=0;p<t.board.length;p++)t.board[p]!="-"&&(s=!1);s&&(console.log("empty board"),console.log(n.boardToFen())),t.currentTurnColor=t.currentTurnColor=="white"?"black":"white";let r=t.findPseudoLegalMoves(t),i;for(let p=0;p<n.Pieces.length;p++)n.Pieces[p].type=="k"&&n.Pieces[p].color==n.currentTurnColor&&(i=n.Pieces[p].getIndex());r.length==0&&(console.log("main board"),n.displayBoard(),console.log(n.fen),console.log("thingy"),t.displayBoard(),console.log(t.fen));for(let p=0;p<r.length;p++)if(r[p].boardEndIndex==i)return!0;return!1}testIsInCheck(){let n=new ce,t=[];t.push(!this.isInCheck(n));for(let s=0;s<t.length;s++)if(!t[s])throw new Error("Is in check failed, test "+(s+1)+" failed")}Piece(n){let t=n.x+n.y*8;for(let s=0;s<this.Pieces.length;s++)if(this.Pieces[s].getIndex()==t)return this.Pieces[s];return" "}addPiece(n){this.Pieces.push(n),this.board[n.getIndex()]!=null&&this.board[n.getIndex()]!=" "&&console.log("ERROR: PIECE ALREADY EXISTS AT THIS LOCATION",n),this.board[n.getIndex()]=n.type}findPawnMoves(n,t){let s=[],r=n.getIndex(),i=new T(r%8,Math.floor(r/8)),p=n.color;if(p!=this.currentTurnColor)return s;if(p=="white"){let c=new T(i.x,i.y-1);t.Piece(c)==" "&&i.y!=0&&s.push(new y(i,c));let u=new T(i.x,i.y-2);t.Piece(u)==" "&&t.Piece(c)==" "&&i.y==6&&s.push(new y(i,u));let b=new T(i.x-1,i.y-1);t.Piece(b)!=" "&&t.Piece(b)?.color=="black"&&i.x-1>=0&&i.y-1>=0&&s.push(new y(i,b));let w=new T(i.x+1,i.y-1);if(t.Piece(w)!=" "&&t.Piece(w)?.color=="black"&&i.x+1<=7&&i.y-1>=0&&s.push(new y(i,w)),t.enPassantTargetSquare!="-"&&i.y==3){let j=new T(t.enPassantTargetSquare.charCodeAt(0)-97,8-parseInt(t.enPassantTargetSquare[1]));sn(j,w)===!0&&s.push(new y(i,w)),sn(j,b)===!0&&s.push(new y(i,b))}}else{let c=new T(i.x,i.y+1);t.Piece(c)==" "&&i.y!=7&&s.push(new y(i,c));let u=new T(i.x,i.y+2);t.Piece(u)==" "&&t.Piece(c)==" "&&i.y==1&&s.push(new y(i,u));let b=new T(i.x-1,i.y+1);t.Piece(b)!=" "&&t.Piece(b)?.color=="white"&&i.x-1>=0&&i.y+1<=7&&s.push(new y(i,b));let w=new T(i.x+1,i.y+1);if(t.Piece(w)!=" "&&t.Piece(w)?.color=="white"&&i.x+1<=7&&i.y+1<=7&&s.push(new y(i,w)),t.enPassantTargetSquare!="-"&&i.y===4){let j=new T(t.enPassantTargetSquare.charCodeAt(0)-97,8-parseInt(t.enPassantTargetSquare[1]));sn(j,w)===!0&&s.push(new y(i,w)),sn(j,b)===!0&&s.push(new y(i,b))}}return s}testFindPawnMoves(){let n=new ce,t=this.findPawnMoves(n.Piece(new T(0,6)),n),s=[];s.push(t.length==2),s.push(t[0].toString()=="a2-a3"),s.push(t[1].toString()=="a2-a4");for(let i=0;i<s.length;i++)if(s[i]==!1){console.log("testFindPawnMoves failed");return}s=[],t=this.findPawnMoves(n.Pieces[16],n),s.push(t.length==2),s.push(t[0].toString()=="a2-a3"),s.push(t[1].toString()=="a2-a4");for(let i=0;i<s.length;i++)if(s[i]==!1){console.log("testFindPawnMoves failed");return}n=new ce([]);let r=new xe("a5","black",Qs);n.addPiece(r),r=new xe("a4","white",Qs),n.addPiece(r),t=this.findPawnMoves(r,n),s=[],s.push(t.length==0);for(let i=0;i<s.length;i++)if(s[i]==!1){console.error("testFindPawnMoves failed");return}}findRookMoves(n,t){let s=[],r=n.getIndex(),i=new T(r%8,Math.floor(r/8)),p=n.color;if(p!=t.currentTurnColor)return s;if(p==="white"){for(let c=i.y-1;c>=0;c--){let u=new T(i.x,c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=i.y+1;c<=7;c++){let u=new T(i.x,c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=i.x-1;c>=0;c--){let u=new T(c,i.y);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=i.x+1;c<=7;c++){let u=new T(c,i.y);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}}else{for(let c=i.y-1;c>=0;c--){let u=new T(i.x,c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=i.y+1;c<=7;c++){let u=new T(i.x,c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=i.x-1;c>=0;c--){let u=new T(c,i.y);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=i.x+1;c<=7;c++){let u=new T(c,i.y);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}}return s}testFindRookMoves(){let n=new ce([],"rnbqkbnr/1ppppppp/8/p7/P7/8/1PPPPPPP/RNBQKBNR w KQkq a6 0 2"),t=n.findRookMoves(n.Piece(new T(0,7)),n),s=[];s.push(t.length===2);for(let r=0;r<s.length;r++)if(s[r]==!1){console.log("testFindRookMoves failed");return}}findKnightMoves(n,t){let s=[],r=n.getIndex(),i=new T(r%8,Math.floor(r/8)),p=n.color;if(p!=t.currentTurnColor)return s;if(p==="white"){if(i.x-2>=0&&i.y-1>=0){let c=new T(i.x-2,i.y-1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x+2<=7&&i.y-1>=0){let c=new T(i.x+2,i.y-1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x-2>=0&&i.y+1<=7){let c=new T(i.x-2,i.y+1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x+2<=7&&i.y+1<=7){let c=new T(i.x+2,i.y+1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x-1>=0&&i.y-2>=0){let c=new T(i.x-1,i.y-2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x-1>=0&&i.y+2<=7){let c=new T(i.x-1,i.y+2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x+1<=7&&i.y-2>=0){let c=new T(i.x+1,i.y-2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}if(i.x+1<=7&&i.y+2<=7){let c=new T(i.x+1,i.y+2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="black"&&s.push(new y(i,c))}}else{if(i.x-2>=0&&i.y-1>=0){let c=new T(i.x-2,i.y-1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x+2<=7&&i.y-1>=0){let c=new T(i.x+2,i.y-1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x-2>=0&&i.y+1<=7){let c=new T(i.x-2,i.y+1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x+2<=7&&i.y+1<=7){let c=new T(i.x+2,i.y+1);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x-1>=0&&i.y-2>=0){let c=new T(i.x-1,i.y-2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x-1>=0&&i.y+2<=7){let c=new T(i.x-1,i.y+2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x+1<=7&&i.y-2>=0){let c=new T(i.x+1,i.y-2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}if(i.x+1<=7&&i.y+2<=7){let c=new T(i.x+1,i.y+2);t.Piece(c)===" "?s.push(new y(i,c)):t.Piece(c)?.color==="white"&&s.push(new y(i,c))}}return s}testFindKnightMoves(){let n=new ce([]),t=[];n.currentTurnColor="white";let s=new xe("c3","white",hi);n.addPiece(s);let r=n.findKnightMoves(s,n);t.push(r.length===8),n=new ce([]),s=new xe("c3","black",hi),n.addPiece(s),n.currentTurnColor="black",r=n.findKnightMoves(s,n),t.push(r.length===8),n=new ce([]),s=new xe("a1","white",hi),n.addPiece(s),r=n.findKnightMoves(s,n),t.push(r.length===2);for(let i=0;i<t.length;i++)if(!t[i]){console.log("testFindKnightMoves failed at test "+i);return}}findBishopMoves(n,t){let s=[],r=n.getIndex(),i=new T(r%8,Math.floor(r/8)),p=n.color;if(p!=t.currentTurnColor)return s;if(p==="white"){for(let c=1;c<=7&&!(i.x-c<0||i.y-c<0);c++){let u=new T(i.x-c,i.y-c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x+c>7||i.y-c<0);c++){let u=new T(i.x+c,i.y-c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x-c<0||i.y+c>7);c++){let u=new T(i.x-c,i.y+c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x+c>7||i.y+c>7);c++){let u=new T(i.x+c,i.y+c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="black"){s.push(new y(i,u));break}else break}}else{for(let c=1;c<=7&&!(i.x-c<0||i.y+c>7);c++){let u=new T(i.x-c,i.y+c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x+c>7||i.y+c>7);c++){let u=new T(i.x+c,i.y+c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x-c<0||i.y-c<0);c++){let u=new T(i.x-c,i.y-c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}for(let c=1;c<=7&&!(i.x+c>7||i.y-c<0);c++){let u=new T(i.x+c,i.y-c);if(t.Piece(u)===" ")s.push(new y(i,u));else if(t.Piece(u)?.color==="white"){s.push(new y(i,u));break}else break}}return s}testFindBishopMoves(){let n=new ce([]),t=new xe("a2","white",Kt);n.addPiece(t);let s=n.findBishopMoves(t,n);if(s.length!==7){console.log("testFindBishopMoves failed 0");return}if(n=new ce([]),t=new xe("a2","black",Kt),n.addPiece(t),n.currentTurnColor="black",s=n.findBishopMoves(t,n),s.length!==7){console.log("testFindBishopMoves failed 1");return}if(n=new ce([]),t=new xe("a2","white",Kt),n.addPiece(t),n.currentTurnColor="black",t=new xe("b3","black",Kt),n.addPiece(t),s=n.findBishopMoves(t,n),s.length!==9){console.log("testFindBishopMoves failed 2");return}if(n=new ce([]),t=new xe("a2","black",Kt),n.addPiece(t),t=new xe("b3","white",Kt),n.addPiece(t),s=n.findBishopMoves(t,n),s.length!==9){console.log("testFindBishopMoves failed 3");return}}findQueenMoves(n,t){let s=this.findRookMoves(n,t);return s.push(...this.findBishopMoves(n,t)),s}testFindQueenMoves(){let n=new ce([]),t=new xe("a2","white",Yt);n.addPiece(t);let s=n.findQueenMoves(t,n);if(s.length!==21){console.log(s),console.error("testFindQueenMoves failed 0");return}if(n=new ce([]),t=new xe("a2","black",Yt),n.addPiece(t),n.currentTurnColor="black",s=n.findQueenMoves(t,n),s.length!==21){n.displayBoard(),console.log(s),console.error("testFindQueenMoves failed 1");return}if(n=new ce([]),t=new xe("a2","white",Yt),n.addPiece(t),n.currentTurnColor="black",t=new xe("b3","black",Yt),n.addPiece(t),s=n.findQueenMoves(t,n),s.length!==23){console.error("testFindQueenMoves failed 2");return}if(n=new ce([]),t=new xe("a2","black",Yt),n.addPiece(t),t=new xe("b3","white",Yt),n.addPiece(t),s=n.findQueenMoves(t,n),s.length!==23){console.error("testFindQueenMoves failed 3");return}}findKingMoves(n,t){let s=[],r=n.getPos().pos;if(n.color==="black"){let i=new T(r.x,r.y+1);t.Piece(i)===" "&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x,r.y-1),t.Piece(i)===" "&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x+1,r.y),t.Piece(i)===" "&&r.x+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x+1<=7&&s.push(new y(r,i)),i=new T(r.x-1,r.y),t.Piece(i)===" "&&r.x-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x-1>=0&&s.push(new y(r,i)),i=new T(r.x+1,r.y+1),t.Piece(i)===" "&&r.x+1<=7&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x+1<=7&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x-1,r.y+1),t.Piece(i)===" "&&r.x-1>=0&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x-1>=0&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x+1,r.y-1),t.Piece(i)===" "&&r.x+1<=7&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x+1<=7&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x-1,r.y-1),t.Piece(i)===" "&&r.x-1>=0&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="white"&&r.x-1>=0&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x+2,r.y),t.Piece(i)===" "&&r.x+2===6&&r.y===0&&this.inCheck===!1&&t.Piece(new T(r.x+1,r.y))===" "&&t.castlingRights.includes("k")&&s.push(new y(r,i)),i=new T(r.x-2,r.y),t.Piece(i)===" "&&r.x-2===2&&r.y===0&&this.inCheck===!1&&t.Piece(new T(r.x-1,r.y))===" "&&t.Piece(i)===" "&&t.castlingRights.includes("q")&&s.push(new y(r,i))}else{let i=new T(r.x,r.y+1);t.Piece(i)===" "&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x,r.y-1),t.Piece(i)===" "&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x+1,r.y),t.Piece(i)===" "&&r.x+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x+1<=7&&s.push(new y(r,i)),i=new T(r.x-1,r.y),t.Piece(i)===" "&&r.x-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x-1>=0&&s.push(new y(r,i)),i=new T(r.x+1,r.y+1),t.Piece(i)===" "&&r.x+1<=7&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x+1<=7&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x-1,r.y+1),t.Piece(i)===" "&&r.x-1>=0&&r.y+1<=7?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x-1>=0&&r.y+1<=7&&s.push(new y(r,i)),i=new T(r.x+1,r.y-1),t.Piece(i)===" "&&r.x+1<=7&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x+1<=7&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x-1,r.y-1),t.Piece(i)===" "&&r.x-1>=0&&r.y-1>=0?s.push(new y(r,i)):t.Piece(i)?.color==="black"&&r.x-1>=0&&r.y-1>=0&&s.push(new y(r,i)),i=new T(r.x+2,r.y),t.Piece(i)===" "&&r.x+2===6&&r.y===7&&this.inCheck===!1&&t.Piece(new T(r.x+1,r.y))===" "&&t.castlingRights.includes("K")&&s.push(new y(r,i)),i=new T(r.x-2,r.y),t.Piece(i)===" "&&r.x-2===2&&r.y===7&&this.inCheck===!1&&t.Piece(new T(r.x-1,r.y))===" "&&t.Piece(i)===" "&&t.castlingRights.includes("Q")&&s.push(new y(r,i))}return s}testFindKingMoves(){let n=new ce([]),t=new xe("a2","white",Gt);n.addPiece(t);let s=n.findKingMoves(t,n);if(s.length!==5){console.error("testFindKingMoves failed 0",s);return}if(n=new ce([]),t=new xe("a2","black",Gt),n.addPiece(t),n.currentTurnColor="black",s=n.findKingMoves(t,n),s.length!==5){console.error("testFindKingMoves failed 1");return}if(n=new ce([]),t=new xe("a2","white",Gt),n.addPiece(t),n.currentTurnColor="black",t=new xe("b3","black",Gt),n.addPiece(t),s=n.findKingMoves(t,n),s.length!==8){console.error("testFindKingMoves failed 2");return}if(n=new ce([]),t=new xe("a2","black",Gt),n.addPiece(t),t=new xe("b3","white",Gt),n.addPiece(t),s=n.findKingMoves(t,n),s.length!==8){console.error("testFindKingMoves failed 3");return}}runAllTests(){this.testConvertToPosition(),this.testConstructors(),this.testBoardToFen(),this.testFenToBoard(),this.testFindPawnMoves(),this.testFindRookMoves(),this.testFindKnightMoves(),this.testFindBishopMoves(),this.testFindQueenMoves(),this.testFindKingMoves(),this.testFindPseudoLegalMoves(),this.testIsInCheck(),this.testFindLegalMoves(),console.log("All tests ran for board class")}}class ro{runAllTests(){new y(void 0,void 0,"a2","a4").runAllTests(),new xt("a2").runAllTests(),new xe("a2","white","pawn").runAllTests(),new ce().runAllTests(),console.log("All tests ran for chessClasses.ts")}}function sn(a,n){return a&&n&&typeof a=="object"&&typeof n=="object"?Object.keys(a).length===Object.keys(n).length&&Object.keys(a).reduce(function(t,s){return t&&sn(a[s],n[s])},!0):a===n}const lo=Pr();function ao(a){const[n,t]=W({x:0,y:0}),[s,r]=W({x:0,y:0}),[i,p]=W(!1),[c,u]=W(null),[b,w]=W(null),[j,D]=W({x:0,y:0}),[x,C]=W(null),[E,L]=W(null),[M,N]=W({x:0,y:0}),[F,O]=W({x:0,y:0}),[se,R]=W(!1),[A,I]=W(null),[ee,pe]=W(null),[q,Ve]=W({x:0,y:0}),[de,Ce]=W(null),[He,ue]=W(null),[Z,he]=W([]),_=[],g=[];We(()=>{document.addEventListener("pointermove",$=>{t({x:$.clientX,y:$.clientY}),i()&&c()&&(c().ref.style.transform=`translate(${n().x-s().x+j().x}px, ${n().y-s().y+j().y}px)`,c().ref.style.zIndex=100,c().rectangle=c().ref.getBoundingClientRect(),x()?.length>0&&L(bt(x())))}),document.addEventListener("pointerup",$=>{c()!=null&&(c().dragEnd(E()),g.forEach(m=>{m($)}),c()?.ref&&(c().ref.style.transform=`translate(${0}px, ${.1}px)`,c().ref.style.zIndex=0),p(!1),w(c()),u(null))}),document.addEventListener("virtualpointermove",$=>{N({x:$.clientX,y:$.clientY}),se()&&A()&&(A().ref.style.transform=`translate(${M().x-F().x+q().x}px, ${M().y-F().y+q().y}px)`,A().ref.style.zIndex=100,A().rectangle=A().ref.getBoundingClientRect(),de()?.length>0&&ue(dn(de())))}),document.addEventListener("virtualpointerup",$=>{A()!=null&&(A().dragEnd(He()),g.forEach(m=>{m($)}),A()?.ref&&(A().ref.style.transform=`translate(${0}px, ${.1}px)`,A().ref.style.zIndex=0),R(!1),pe(A()),I(null))})});const le=($,m)=>{m!==void 0&&m.dragStart.push($)},Y=$=>{_.push($)},H=$=>{g.push($)},oe=($,m)=>{m!==void 0&&(m.dragEnd=$)},ge=($,m)=>{m!==void 0&&(m.hoverOver=$)},me=($,m)=>{m!==void 0&&(m.hoverOut=$)},Le=$=>{let m={id:$,startingPosition:{x:0,y:0},dragStart:[],dragEnd:()=>{},ref:null,rectangle:null,data:{}};return We(()=>{m.ref.addEventListener("pointerdown",te=>{if(!m.ref.classList.contains("noDrag")){u(m);for(let Q=0;Q<m.dragStart.length;Q++)m.dragStart[Q](m);for(let Q=0;Q<_.length;Q++)_[Q](m);D(ut(te.target.getAttribute("style"))),r({x:te.clientX,y:te.clientY}),p(!0),m.rectangle=m.ref.getBoundingClientRect()}}),m.ref.addEventListener("virtualpointerdown",te=>{I(m);for(let Q=0;Q<m.dragStart.length;Q++)m.dragStart[Q](m);for(let Q=0;Q<_.length;Q++)_[Q](m);Ve(ut(te.target.getAttribute("style"))),O({x:te.clientX,y:te.clientY}),R(!0),m.rectangle=m.ref.getBoundingClientRect()})}),m},Oe=$=>{let m={id:$,startingPosition:{x:0,y:0},hoverOver:()=>{},hoverOut:()=>{},ref:null,rectangle:null,hovering:!1,occupied:!1,droppable:!0};return he([...Z(),m]),We(()=>{m.rectangle=m.ref.getBoundingClientRect(),m.ref.querySelector(".piece")!==null&&(m.occupied=!0),document.addEventListener("pointermove",()=>{if(c()==null||c().rectangle==null)return;let te=c().ref.getBoundingClientRect(),Q=m.ref.getBoundingClientRect();if(te.top>Q.bottom||te.right<Q.left||te.bottom<Q.top||te.left>Q.right){if(kt(m),!m.hovering)return;m.hovering=!1,m.hoverOut(c())}else{if(m.ref===E()?.ref){if(m.hovering)return;m.hovering=!0,m.hoverOver(c())}else m.hovering=!1,m.hoverOut(c());st(m)}}),document.addEventListener("pointerdown",()=>{if(c()==null||c().rectangle==null)return;let te=c().ref.getBoundingClientRect(),Q=m.ref.getBoundingClientRect();if(te.top>Q.bottom||te.right<Q.left||te.bottom<Q.top||te.left>Q.right){if(kt(m),!m.hovering)return;m.hovering=!1,m.hoverOut(c())}else{if(m.ref===E()?.ref){if(m.hovering)return;m.hovering=!0,m.hoverOver(c())}else m.hovering=!1,m.hoverOut(c());st(m)}x()?.length>0&&L(bt(x()))}),document.addEventListener("pointerup",()=>{!m.hovering||(m.hovering=!1,m.hoverOut(b()),b()!=null&&m.droppable!==!1&&(m.ref.querySelector(".piece")!==null?m.ref.querySelector(".piece").remove():m.ref.querySelector(".circle")!==null&&m.ref.querySelector(".circle").remove(),m.ref.appendChild(b().ref)))}),document.addEventListener("virtualpointermove",()=>{if(A()==null||A().rectangle==null)return;let te=A().ref.getBoundingClientRect(),Q=m.ref.getBoundingClientRect();if(te.top>Q.bottom||te.right<Q.left||te.bottom<Q.top||te.left>Q.right){if(cn(m),!m.hovering)return;m.hovering=!1,m.hoverOut(A())}else{if(m.ref===He()?.ref){if(m.hovering)return;m.hovering=!0,m.hoverOver(A())}else m.hovering=!1,m.hoverOut(A());J(m)}}),document.addEventListener("virtualpointerdown",()=>{if(A()==null||A().rectangle==null)return;let te=A().ref.getBoundingClientRect(),Q=m.ref.getBoundingClientRect();if(te.top>Q.bottom||te.right<Q.left||te.bottom<Q.top||te.left>Q.right){if(cn(m),!m.hovering)return;m.hovering=!1,m.hoverOut(A())}else{if(m.ref===He()?.ref){if(m.hovering)return;m.hovering=!0,m.hoverOver(A())}else m.hovering=!1,m.hoverOut(A());J(m)}de()?.length>0&&ue(dn(de()))}),document.addEventListener("virtualpointerup",()=>{!m.hovering||(m.hovering=!1,m.hoverOut(ee()),ee()!=null&&m.droppable!==!1&&(m.ref.querySelector(".piece")!==null?m.ref.querySelector(".piece").remove():m.ref.querySelector(".circle")!==null&&m.ref.querySelector(".circle").remove(),m.ref.appendChild(ee().ref)))})}),Z()[Z().length-1]};function ut($){if($===null)return{x:0,y:0};let m=$.split("translate(")[0],te;return m&&(te=$.split("translate(")[1].split(")")[0].split("px, ")),{x:parseInt(te[0]),y:parseInt(te[1])}}function st($){x()==null&&C([$]),!x().includes($)&&(x()?.includes($)||C([...x(),$]))}function kt($){x()!=null&&(!x()?.includes($)||x().includes($)&&C(x()?.filter(m=>m!==$)))}function bt($){if($==null)return;let m=c().ref.getBoundingClientRect();return $.sort((Q,yt)=>{let Me=Q.ref.getBoundingClientRect(),Ne=yt.ref.getBoundingClientRect(),Ye,ht,ft,pt,ze,gt;return m.x>Me.x?Ye=Me.right-m.x:Ye=m.right-Me.x,m.bottom>Me.bottom?ht=Me.bottom-m.top:ht=m.bottom-Me.top,ze=Ye*ht,m.x>Ne.x?ft=Ne.right-m.x:ft=m.right-Ne.x,m.bottom>Ne.bottom?pt=Ne.bottom-m.top:pt=m.bottom-Ne.top,gt=ft*pt,gt-ze})[0]}function J($){de()==null&&Ce([$]),!de().includes($)&&(de()?.includes($)||Ce([...de(),$]))}function cn($){de()!=null&&(!de()?.includes($)||de().includes($)&&Ce(de()?.filter(m=>m!==$)))}function dn($){if($==null)return;let m=A().ref.getBoundingClientRect();return $.sort((Q,yt)=>{let Me=Q.ref.getBoundingClientRect(),Ne=yt.ref.getBoundingClientRect(),Ye,ht,ft,pt,ze,gt;return m.x>Me.x?Ye=Me.right-m.x:Ye=m.right-Me.x,m.bottom>Me.bottom?ht=Me.bottom-m.top:ht=m.bottom-Me.top,ze=Ye*ht,m.x>Ne.x?ft=Ne.right-m.x:ft=m.right-Ne.x,m.bottom>Ne.bottom?pt=Ne.bottom-m.top:pt=m.bottom-Ne.top,gt=ft*pt,gt-ze})[0]}return G(lo.Provider,{value:{onDragEnd:oe,onDragStart:le,createDraggable:Le,onHoverOver:ge,createDroppable:Oe,onHoverOut:me,onGlobalDragStart:Y,onGlobalDragEnd:H},get children(){return a.children}})}const Ks=()=>xr(lo);class Rr{from;to;type;constructor(n,t,s){this.from=n,this.to=t,this.type=s}}class on{id;username;CatUrl;last_seen=Date.now();inGame=!1;constructor(n,t,s){this.id=n,this.username=t,this.CatUrl=s}}class qr{from;fromUserColor;to;gameID;type="createGame";constructor(n,t){this.from=n,this.to=t,this.fromUserColor=Math.random()>.5?"white":"black",this.gameID=this.generateRandomId()}generateRandomId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}}class Vn{x;y;constructor(n,t){this.x=n,this.y=t}}class fi{from;to;position;screen;type="virtualMouseEvent";eventType;chessBoardWidth;constructor(n,t,s,r,i){this.from=n,this.to=t,this.position=s,this.screen=new Vn(window.innerWidth,window.innerHeight),this.chessBoardWidth=r,this.eventType=i}}class $r{from;to;previousFen;crowning=!1;eating=!1;atePiece="";crownedTo="";castle=!1;turnColor="";enPassant=!1;enPassantSquare="";constructor(n,t,s){this.from=n,this.to=t,this.previousFen=s}}class Fr{fen;from;to;type="chessGameUpdate";turn;moves;constructor(n,t,s,r,i){this.fen=n,this.from=t,this.to=s,this.turn=r,this.moves=i}}const jr=ke('<div class="number-right" style="pointer-events: none;"></div>'),Ur=ke('<div class="number-left" style="pointer-events: none;"></div>'),Hr=ke("<div></div>"),Wr=ke('<section><div class=""> </div></section>');function co({pieceClassName:a,className:n,id:t,board:s,draggableId:r,updateBoard:i,eatenPieces:p,setDisplayInlay:c,setDisplayInlayX:u,inlaySelection:b,displayInlay:w,style:j,color:D,setLastMove:x,lastMove:C,movePieceSound:E,capturePieceSound:L,setMoves:M,moves:N}){We(()=>{window.movePiece=function(A,I){s().movePiece(A,I),i()},window.board=s});const F=({id:A,className:I,draggable:ee,draggableClass:pe})=>{const{onHoverOver:q,createDroppable:Ve,onHoverOut:de,onGlobalDragStart:Ce,onGlobalDragEnd:He}=Ks(),ue=Ve(A);return q(Z=>{ue.ref.classList.add("hovered")},ue),de(Z=>{ue.ref.classList.remove("hovered")},ue),Ce(Z=>{if(!se()&&!w())if(Z.data.legalPieceMoves.includes(ue.id)){if(ue.ref.children.length===0||ue.ref.querySelector(".piece")==null){ue.droppable=!0;let he=document.createElement("section");he.classList.add("circle"),ue.ref.appendChild(he)}else if(ue.ref.children.length>0&&ue.ref.querySelector(".piece")!=null){ue.droppable=!0;let he;for(let _=0;_<ue.ref.children.length;_++)ue.ref.children[_].classList.contains("piece")&&(he=ue.ref.children[_]);he.children[0]?.classList.add("circle")}}else ue.droppable=!1}),He(Z=>{if(Z.srcElement.classList?.contains("piece")){if(D!==s().currentTurnColor)return}else if(D==s().currentTurnColor)return;let he=ue.ref.querySelectorAll("section.circle");for(let g=0;g<he.length;g++)he[g].remove();let _=ue.ref.querySelectorAll("div.circle");for(let g=0;g<_.length;g++)_[g].classList.remove("circle")}),ee.getAttribute("class").length===0&&(ee=void 0),(()=>{const Z=Hr.cloneNode(!0),he=ue.ref;return typeof he=="function"?Hs(he,Z):ue.ref=Z,Nn(Z,"id",A),rn(Z,I),Ae(Z,G(De,{when:ee!=null,children:ee}),null),Ae(Z,G(De,{get when(){return A[1]==="8"&&D==="black"||A[1]==="1"&&D==="white"},get children(){const _=jr.cloneNode(!0);return Ae(_,()=>A[0]),_}}),null),Ae(Z,G(De,{get when(){return A[0]==="h"&&D==="black"||A[0]==="a"&&D==="white"},get children(){const _=Ur.cloneNode(!0);return Ae(_,()=>A[1]),_}}),null),dt(_=>oo(Z,j,_)),Z})()},O=({className:A,id:I})=>{const{onDragStart:ee,onDragEnd:pe,createDraggable:q}=Ks(),Ve=q(I);let de,Ce;ee(()=>{if(w())return;de=Ve.ref.parentElement.id;let Z=s().findLegalMoves(s());Z.length===0&&(s().checkMate=!0);let he=[];for(let _=0;_<Z.length;_++)Z[_].start==de&&he.push(Z[_].end);Ve.data.legalPieceMoves=he},Ve),pe(async Z=>{if(w()||se()||Z===null)return;let he=Z.ref.querySelector(".piece");if(await R(1),he?.id===Ve?.id?Ce=Ve.ref.parentElement.id:Ce=Z.ref.id,Z.ref.querySelector(".circle")===void 0||s().checkMate)return;for(let Y=0;Y<s().legalMoves.length&&!(s().legalMoves[Y].start===de&&s().legalMoves[Y].end===Ce);Y++)if(Y===s().legalMoves.length-1)return;if(Ce===de)return;let _=new $r(de,Ce,s().fen);if(s().enPassantTargetSquare===Ce&&(_.enPassant=!0,_.enPassantSquare=s().enPassantTargetSquare,s().currentTurnColor==="white"?_.enPassantSquare=_.enPassantSquare[0]+(parseInt(_.enPassantSquare[1])-1).toString():_.enPassantSquare=_.enPassantSquare[0]+(parseInt(_.enPassantSquare[1])+1).toString(),_.atePiece=s().getPieceAtPosition(_.enPassantSquare)?.type),_.turnColor=s().currentTurnColor,s().getPieceAtPosition(de)?.type==="k"){let Y=de[0],H=Ce[0];Math.abs(Y.charCodeAt(0)-H.charCodeAt(0))===2&&(_.castle=!0)}he?.classList?.contains("piece")?(p.push(he),_.eating=!0,_.atePiece=s().getPieceAtPosition(Ce)?.type,L.play()):E.play(),s().movePiece(de,Ce);let g=s().getPieceAtPosition(Ce);g.type==="p"&&g.color===D&&(Ce[1]==="8"||Ce[1]==="1")&&(_.crowning=!0,c(!0),u(g.position.pos.x)),M([...N(),_]),i(),(he?.classList?.contains("number-right")||he?.classList?.contains("number-left"))&&Z.ref.appendChild(he),x({from:de,to:Ce});let le=document.querySelectorAll(".chessSquare");for(let Y=0;Y<le.length;Y++)le[Y].id===C().from||le[Y].id===C().to?le[Y]?.classList?.add("lastMove"):le[Y]?.classList?.remove("lastMove")},Ve);const He=a.toUpperCase()===a?"white":"black",ue=D===He;return(()=>{const Z=Wr.cloneNode(!0),he=Ve.ref;return typeof he=="function"?Hs(he,Z):Ve.ref=Z,rn(Z,`${A} ${ue?"canDrag":"noDrag"}`),Nn(Z,"id",I),Z})()};function se(){for(let A=0;A<s().Pieces.length;A++)if(s().Pieces[A].type==="p"&&s().Pieces[A].color!=D&&(s().Pieces[A].position.pos.y===0||s().Pieces[A].position.pos.y===7))return!0}const R=A=>new Promise(I=>setTimeout(I,A));return G(F,{className:n,get draggable(){return G(O,{className:`${a!=" "?a+" piece":""}`,id:r})},id:t})}const Qr=ke('<div class="catLogo"></div>');function Rn({catLink:a}){return(()=>{const n=Qr.cloneNode(!0);return dt(t=>oo(n,`background-image: url(${a})`,t)),n})()}const Kr=ke('<div class="ScoreNPieces"><div class="score"></div></div>'),Gr=ke('<section><div class=""> </div></section>');function uo({color:a,board:n}){const[t,s]=W([]),[r,i]=W(0);return We(()=>{console.log(n()),document.addEventListener("boardUpdated",()=>{s([]),i(0);let p=n().capturedPieces;for(let c=0;c<p.length;c++)switch(p[c].color!=a&&s([...t(),p[c]]),p[c].type){case"p":p[c].color==a?i(r()+-1):i(r()+1);break;case"n":p[c].color==a?i(r()+-3):i(r()+3);break;case"b":p[c].color==a?i(r()+-3):i(r()+3);break;case"r":p[c].color==a?i(r()+-5):i(r()+5);break;case"q":p[c].color==a?i(r()+-9):i(r()+9)}})}),(()=>{const p=Kr.cloneNode(!0),c=p.firstChild;return Ae(c,(()=>{const u=tt(()=>r()!=0);return()=>u()?r():""})()),Ae(p,G($n,{get each(){return t()},children:u=>(()=>{const b=Gr.cloneNode(!0);return dt(()=>rn(b,`eatenPiece ${a=="white"?u.type:u.type.toUpperCase()}`)),b})()}),null),p})()}const ho="data:audio/mpeg;base64,SUQzBAAAAAABH1RFTkMAAAALAAADUHJvIFRvb2xzAFRYWFgAAAAjAAADb3JpZ2luYXRvcl9yZWZlcmVuY2UAYWFPNEt0IUJLdlNrAFREUkMAAAAMAAADMjAxOS0wNC0yMQBUWFhYAAAAGgAAA3RpbWVfcmVmZXJlbmNlADE3MjgwMDAwMABUU1NFAAAADwAAA0xhdmY1OC4yOS4xMDAAAAAAAAAAAAAAAP/7VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEluZm8AAAAPAAAACAAADMAALS0tLS0tLS0tLS0tS0tLS0tLS0tLS0tLaWlpaWlpaWlpaWlpaYeHh4eHh4eHh4eHh6WlpaWlpaWlpaWlpaXDw8PDw8PDw8PDw8Ph4eHh4eHh4eHh4eHh////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQE5gAAAAAAAAzAei0vIf/7lGQAAAMuHciFc0ACKuFWcqGYABC8uU9ZrIAQvopiQzUgADDQIHQuY1I5kkbmEQMZCOBo5LGfhoY3Q5wCCG7FcZeABikmmUyCEDYxYSDJgwFBCeTceaYaoQlKYUGq8uYBgjTQICBQBgl7O5DEOXqSxunjcvp8+///nXp6enpKSkpMGQ8AAAAAVASoEJwMWaIIFnEIOBiwgDC0xA4+sH1AgUBA4XeD/KHP/KOBB2Iz/8oc4PgAAAV9uRSW0SBsALDmsjFUiIVimojFGpsmc0mEHFEgmImJJGdXBQmCU7d1xiRADooPLkDg3Tlo1aDtFMBZFBHFy8KHqaa4WEtu/DhbYDWszG5ukhTXYo8butg1ayrU0pl/f/3Wgvdbk5SZ3O1cr+W98/79S93//LKmEAY9bwE5c274qni5H6i+zFmyQGVb9iwZ0OLDTNIQtIz9JN/B44YsS8DsQxmDdxty3QJkkDLoPRNX/t/KqgA/AQBAxudAcqzBpfMoGwyjGTUw1P/7lGQKjNP7PEoXciAAMKIIwuy8AA40mRItpHRAvgnjjPSKCMvrY0aVAMPiIWG3ouayUpjwZmEhIIwqYgDJigBC2gLABTENAWoLgckQqLhHCQIMjBYcIJGJAiDJF01GVNT02U5w6Ymqkkq1o2RZToLqSUtSSWu3mJrRpLqW1J/3WrutaKKLTM9mwMnW54TBIAGFVQwoBg8EHKXCBUOHL9KRM69DVlqA5E1S5NUpxHiEnmW4ucVtnVdo/gj6n/RrCIeMjIUgxXINrUzbAEyO4OajQEgBVIMREDMUw3IcNDWTru83qTNagzJCciABx9FmgqgQNEgUFMWrKzNaZW77AQ0wAJsgbBUUAkiSRY4CjAJEG/tUL0goDpAuD7n0KNdIodOvt29UXOgUNVm1Xu+z+ixQcg53hkEpCFI8eoMUHKeQUgQEE6BpMpOCCDHKVHHAfXCFxiNQbqBdFFRRHGsgUjbVBCADEgMKGps3iDRM0aBOSPgcfGbNBjqeY45m9Uxgif/7lGQPjNNfIsMTeCtANMJ4kWMpOguUTwwtZYzA/InhQawhmKXTNCmRp5MVDOU1/A3D4dVADBS8Vgh54GUt0FgsCkLuOpTUciUDuFmhr2R5aCScrDJHGOjw66jPSLou5cks/9C9hKt65fbxCGR12hUqwEw5IgHIQUIpsF3EyB3sSWMNwxgDIjKkoDEJCkU5YqdqzP3kiKhkneX0NGrTjtZSzCLdP2oAvMgcm5DmDHnTqnTWgKIZwydHMZpYcXMG3Bt2YmmGDjFGj4raZzajqdEAqPzLvQY5a44rs5OAqNDz21SsJBpx2pinhsBHHrW6/1ertWxdFC6kMRXqeq2l96eK5CnRDHlY0HNg1NPRF9R0w4mMNcRMn+KTIFYmDImSMBQgecB/CuAHYZKokKsCz36tsNXiyaeNwksVdC/8AWiwSWpCUIAsSwTGQoGE5hscCkptEJssKg5g0Z4VZyyhxHhwBZka4OGGSIGtSk0ZRZGMcFkRqGWmOqxCsj40bgcsg//7lGQfDtL/IEKDellwSQKIMGd4Ggx4TwYtc0aQ9YjhxbxoiEeWJ246o3+K9t3wx/VytFNdclWyUV6+1Ewr6jWhvrdlvy7wBZExnztBL8DMEbOFGyERtxgBEo3SGNxVTKjcRm5goKBAZYM1YvPWgqY0vRfEJQYKCmjsZVFld0+7h4ZWtQ7INGw/RkkC4uXSEQASUYVRANQMqMZhOkDBSQBXoyqRgwynKh+YKFAOjRgYHGFinQIGNAGJiCxhMkeBpgsjas4THpuGIRFo9NXbv3KaRCRxwqNLAit5UBKeWi307S2//I2KJEsq76Nt/4yVZ5uowi25CHEwEGMPDjNogxGOkjbc0CMEoJ5YcfMmRAyV/VhDJiCyQVAQQlsvFb87ZgZrzKqCpZj33R4SVdrRuYprI0BmkhpQXnap5yP+ZKqm3zZoTMZ/CmI8x4x0UOBzKYbeIobmZZnPGnjEiqIxKMmVoPGMFvHCFY0ZCIG9y4BQc8VVaYkmvvbDXrbOXaenpf/7lGQoD/LbH7+DemMwTSPIEG8naExogvgObYlBTY8fwb0lmG8tWwfjGz//yvZ9DkAYHAycYyUNTOTEjXGAw93MsfQSemCox1SgYKamTuhACElghTDoSIA01gsyEMAQVAGwRiDsIeuwhTFYKi8s1AzCwOaim284yvHVLQpWNhUnmREkJOALFU5M6DY6jOKQg5wPTn6uNFagMsH4gRybSBkMxAAK2U6onMOOzPyQxolMHAAQPD0WAQhHNO0OS1Fl9LggA2EY4m68tDf4XfhirsVuZi09Z1pL3R5AzknH//5ZsRAhmPAprSYnqbRmmHpgBwDVDA4kfNdWThk0ws5PiQTJFsylw4pAQHjwZTABS3LZwqgGRzdV9MuZ6mgtQRAECyM45NEvStZXzx+ZDLxXpzYYF/TVjAIHzBxIwIbM7FDG1QARhqB+dPJg6bOtfTyVY5NBOCcDBjsxsOMtNjGFk+4TM3NCI2BTHbFVlWoy3gIyABx4io7bFXutzXJA8+c1Z//7lGQmD/LYID6DeTPAVgQH0G8GhAuUgPYOaStBNI5fgbyVoQtTT/eYX/qrSCTKRW1TaF9Eo2ckRFDeLgZlGodSREXAO5JprwOmJjBgdOpmDFpgRAZHHArOMiGTUhswQCDB4vsYTDB0+4Id8yjW4509JXslUzGzSylk0HbW/di7Kmi9cC2LF6nrVOIAYZ5NRnwWjKgNKL4xsDjRsrM1EQBU8xIyQRJCNGexCePiaCuCQZuUpkFZi05gnIhQJfGfTrmeZ2RIc4Sb87CHCkDGZC2OhaKsZ3tXO6yFwpH46V1YhPrzT2d8SVVVgQFGNFxltsaWxHmtAEXCagNShSFHCRo1IVMXMwRicYxvGnBCBBTfVdAVGGS1gplphc5orBJt93mg+/NOKgdzXJ21IPMQRVAHJ211RoSJjscXTKEAS9TSRI3dZPKOTVyQzsxBcYmEb8SGJqZk4OaeDmHXp7+i4giUIFAEe/zhP+glTdbmyd35Q1vCW7BxY8gc7PsyvK9Jqf/7lGQmj/KeID2DeTOwVEPH0HNoPgoQUPYMbyGJVA8egc0Nce6rSTHaP6X/GAYJDUWIBggPmP4cZ2HoVCgQ2GgDppP+bPLmsmh1LMZoWGFBRNGFwS9AyRCgYFwUDAosBtEwaECgJNK9bmWWapqtCGGGVVnvt9yzd4hzBHBtDuoCGEETSxADNAKJThz4zIDMPPDTUoyI5OINzb0gy8sNQgTOCYyNTNOGzSjUyZgsSJHGIKZCKACRqbNacVmzgSOJtN+rqZjk/pNV7tqigVI2yiT5MEggw0NRYTmPkYaBdpuogGWwWYPA5FKzcg6OTpI8uQ2yEyI8w+g2uc9VApSEo4HVyyCcZqmaQCtrpMPZIw3sSZDIL2dZ62a73yt3lIubUMfRLMwVMCeNOSMA/Hxp18xg7J6iJxZAoVNJFMVgDUUE/zU1cQeZCgs1Bsx8IywQ1ZwVDgoq8S7nGglUrxqavVA0t1vVXdmta2bz/+YYVVJJdGFVFF83z0w841aMFgTShP/7lEQtj/JfFLiDW9ICSeJ3AGssWEAAAaQAAAAgAAA0gAAABDSGTXyjF3DZrwOZO9wyHRWAyzQOCZKSCAoKLog0RDMMJROf90k9mHq9BI7ULmz05WPEhs0x27/3fUSJTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",Yr=ke('<div class="arrows"><div>&lt;&lt;</div><div>&lt;</div><div>></div><div>>></div></div>');function zr({moves:a}){function n(){let E=document.querySelector(".chessBoard").getBoundingClientRect().height,L=window.innerHeight,M=document.querySelector(".arrows");M.getBoundingClientRect();let O=document.querySelector(".userNameWidgetHolder").getBoundingClientRect().height;M.style.top=`${E+(L-E)/2+O/1.3}px`}We(()=>{n(),window.addEventListener("resize",()=>{n()})});const[t,s]=W(-1),r=new Audio(ho);let i=!1;We(()=>{document.addEventListener("boardUpdated",x=>{s(a().length-1),i=!1})});async function p(x){return new Promise(C=>setTimeout(C,x))}async function c(x,C=!0){let E=x,L=document.querySelectorAll(".chessSquare");for(let q=0;q<L.length;q++)L[q].id===E.from||L[q].id===E.to?L[q]?.classList?.add("lastMove"):L[q]?.classList?.remove("lastMove");let M=document.getElementById(x.to)?.querySelector(".piece"),N=document.getElementById(x.to),F=document.getElementById(x.from),O=N?.getBoundingClientRect(),se={x:O?.x+O?.width/2,y:O?.y+O?.height/2},R=F?.getBoundingClientRect(),A={x:R?.x+R?.width/2,y:R?.y+R?.height/2},I={x:A.x-se.x,y:A.y-se.y},ee=Math.sqrt(I.x**2+I.y**2),pe={x:I.x/ee,y:I.y/ee};if(!!M){for(let q=0;q<ee;q++)M.style.transform=`translate(${pe.x*q}px, ${pe.y*q}px)`,q%10===0&&C?await p(.001):q%50===0&&await p(.001);if(F?.appendChild(M),x.atePiece&&!x.enPassant){let q=document.createElement("section");q.classList.add("piece"),x.turnColor==="black"?q.classList.add(x.atePiece.toUpperCase()):q.classList.add(x.atePiece.toLowerCase()),N?.appendChild(q)}if(M.style.transform="translate(0.1px, 0.1px)",x.enPassant){let q=document.createElement("section");q.classList.add("piece"),x.turnColor==="black"?q.classList.add(x.atePiece.toUpperCase()):q.classList.add(x.atePiece.toLowerCase()),document.getElementById(x.enPassantSquare)?.appendChild(q)}C&&r.play(),C&&r.play()}}async function u(x,C=!0){let E=x,L=document.querySelectorAll(".chessSquare");for(let q=0;q<L.length;q++)L[q].id===E.from||L[q].id===E.to?L[q]?.classList?.add("lastMove"):L[q]?.classList?.remove("lastMove");let M=document.getElementById(x.from)?.querySelector(".piece"),N=document.getElementById(x.from),F=document.getElementById(x.to),O=N?.getBoundingClientRect(),se={x:O?.x+O?.width/2,y:O?.y+O?.height/2},R=F?.getBoundingClientRect(),A={x:R?.x+R?.width/2,y:R?.y+R?.height/2},I={x:A.x-se.x,y:A.y-se.y},ee=Math.sqrt(I.x**2+I.y**2),pe={x:I.x/ee,y:I.y/ee};try{for(let q=0;q<ee;q++)M.style.transform=`translate(${pe.x*q}px, ${pe.y*q}px)`,q%10===0&&C?await p(.001):q%50===0&&await p(.001);F?.querySelector(".piece")&&F?.querySelector(".piece")?.remove(),F?.appendChild(M),M.style.transform="translate(0.1px, 0.1px)",x.enPassant&&document.getElementById(x.enPassantSquare)?.querySelector(".piece")?.remove(),C&&r.play()}catch(q){console.log(q)}}async function b(){for(let x=t();x>-1;x--)await w(!1);r.play()}async function w(x=!0){if(i=!0,a().length===0){i=!1;return}if(t()===-1){i=!1;return}if(await c(a()[t()],x),a()[t()].castle){let C=a()[t()].to,E;switch(C){case"g1":E=document.getElementById("f1")?.querySelector(".piece"),document.getElementById("h1")?.appendChild(E);break;case"c1":E=document.getElementById("d1")?.querySelector(".piece"),document.getElementById("a1")?.appendChild(E);break;case"g8":E=document.getElementById("f8")?.querySelector(".piece"),document.getElementById("h8")?.appendChild(E);break;case"c8":E=document.getElementById("d8")?.querySelector(".piece"),document.getElementById("a8")?.appendChild(E)}}s(t()-1),i=!1}async function j(x=!0){if(i=!0,a().length===0){i=!1;return}if(t()===a().length-1){i=!1;return}if(await u(a()[t()+1],x),s(t()+1),a()[t()].castle){let C=a()[t()].to,E;switch(C){case"g1":E=document.getElementById("h1")?.querySelector(".piece"),document.getElementById("f1")?.appendChild(E);break;case"c1":E=document.getElementById("a1")?.querySelector(".piece"),document.getElementById("d1")?.appendChild(E);break;case"g8":E=document.getElementById("h8")?.querySelector(".piece"),document.getElementById("f8")?.appendChild(E);break;case"c8":E=document.getElementById("a8")?.querySelector(".piece"),document.getElementById("d8")?.appendChild(E)}}i=!1}async function D(){for(let x=t();x<a().length-1;x++)await j(!1);r.play()}return(()=>{const x=Yr.cloneNode(!0),C=x.firstChild,E=C.nextSibling,L=E.nextSibling,M=L.nextSibling;return C.$$click=async()=>{i===!1&&b()},E.$$click=async()=>{i===!1&&w()},L.$$click=async()=>{i===!1&&j()},M.$$click=async()=>{i===!1&&D()},x})()}Nt(["click"]);const Xr=ke('<div class="userNameWidgetHolder user"><div class="userNameWidget"><div class="userName"></div></div></div>');function fo({user:a,color:n,board:t,moves:s}){function r(){let c=document.querySelector(".chessBoard").getBoundingClientRect().height,u=window.innerHeight,b=document.querySelector(".userNameWidgetHolder.user");b.getBoundingClientRect(),b.style.top=`${c+(u-c)/2}px`}return We(()=>{r(),window.addEventListener("resize",()=>{r()})}),[(()=>{const i=Xr.cloneNode(!0),p=i.firstChild,c=p.firstChild;return Ae(c,()=>a()?.username||"404 not found"),Ae(p,G(Rn,{get catLink(){return tt(()=>!!a()?.CatUrl)()?a()?.CatUrl:"https://cdn2.thecatapi.com/images/dt5.jpg"}}),null),Ae(i,G(uo,{color:n,board:t}),null),i})(),G(zr,{moves:s})]}const Jr=ke('<div class="userNameWidgetHolder opponent"><div class="userNameWidget"><div class="userName"></div></div></div>');function po({opponent:a,color:n,board:t}){function s(){let p=document.querySelector(".chessBoard").getBoundingClientRect().height,c=window.innerHeight,u=document.querySelector(".userNameWidgetHolder.opponent"),w=u.getBoundingClientRect().height;u.style.top=`${(c-p)/2-w}px`}return We(()=>{s(),window.addEventListener("resize",()=>{s()})}),(()=>{const r=Jr.cloneNode(!0),i=r.firstChild,p=i.firstChild;return Ae(p,()=>a()?.username||"404 not found"),Ae(i,G(Rn,{get catLink(){return tt(()=>!!a()?.CatUrl)()?a()?.CatUrl:"https://cdn2.thecatapi.com/images/dt5.jpg"}}),null),Ae(r,G(uo,{color:n,board:t}),null),r})()}const Zr=ke('<div><div class="chessInlaySquare" id="queenSelection"><div class="piece Q"></div></div><div class="chessInlaySquare" id="knightSelection"><div class="piece N"></div></div><div class="chessInlaySquare" id="rookSelection"><div class="piece R"></div></div><div class="chessInlaySquare" id="bishopSelection"><div class="piece B"></div></div></div>'),el=ke('<div class="chessBoard"></div>');let tl=new ro;tl.runAllTests();function nl({board:a,updateBoard:n,setLastMove:t,lastMove:s,movePieceSound:r,capturePieceSound:i,setMoves:p,moves:c,user:u,opponent:b,inGame:w}){a().displayBoard();let j=D();function D(){let R=[];for(let A=0;A<8;A++)for(let I=0;I<8;I++)R.push(`${String.fromCharCode(97+I)}${8-A}`);return R}let x=[];const[C,E]=W(!1),[L,M]=W("00"),[N,F]=W("");L()+"";async function O(R){F(R),E(!1);let A=c()[c().length-1];A.crownedTo=R.toLowerCase();let I=c().splice(0,c().length-1);I.push(A),p(I);let ee=a().getPieceAtBoardIndex(parseInt(L())),pe=ee.type;ee.type=R.toLowerCase(),a().board[parseInt(L())]=R,a().fen=a().boardToFen(),console.log(ee);let q=document.getElementById(ee.position.position)?.children[0];console.log("previous type:"+pe),q?.classList.remove(pe.toUpperCase()),q?.classList.add(R.toUpperCase()),await se(10),n()}function se(R){return new Promise(A=>setTimeout(A,R))}return[G(De,{get when(){return w()},get children(){return G(po,{opponent:b,color:"black",board:a})}}),(()=>{const R=el.cloneNode(!0);return Ae(R,G(ao,{get children(){return[G(De,{get when(){return C()},get children(){const A=Zr.cloneNode(!0),I=A.firstChild,ee=I.nextSibling,pe=ee.nextSibling,q=pe.nextSibling;return I.$$click=()=>O("Q"),ee.$$click=()=>O("N"),pe.$$click=()=>O("R"),q.$$click=()=>O("B"),dt(()=>rn(A,`chessInlay ml-[${L()}]`)),A}}),G($n,{get each(){return a().board},children:(A,I)=>G(co,{get style(){return I()},get pieceClassName(){return a().board[I()]},get className(){return`chessSquare ${I()%16<8?I()%2==0?"lighterBackground":"":I()%2==0?"":"lighterBackground"}`},get id(){return j[I()]},board:a,updateBoard:n,get draggableId(){return il()},eatenPieces:x,setDisplayInlay:E,setDisplayInlayX:M,inlaySelection:N,displayInlay:C,color:"white",setLastMove:t,lastMove:s,movePieceSound:r,capturePieceSound:i,setMoves:p,moves:c})})]}})),R})(),G(De,{get when(){return w()},get children(){return G(fo,{user:u,color:"white",board:a,moves:c})}})]}function il(){return Math.random().toString(36).substr(2,9)}Nt(["click"]);const sl=ke('<div><div class="chessInlaySquare" id="queenSelection"><div class="piece q"></div></div><div class="chessInlaySquare" id="knightSelection"><div class="piece n"></div></div><div class="chessInlaySquare" id="rookSelection"><div class="piece r"></div></div><div class="chessInlaySquare" id="bishopSelection"><div class="piece b"></div></div></div>'),ol=ke('<div class="chessBoard"></div>');let rl=new ro;rl.runAllTests();function ll({board:a,updateBlackBoard:n,setLastMove:t,lastMove:s,movePieceSound:r,capturePieceSound:i,setMoves:p,moves:c,user:u,opponent:b,inGame:w}){a().displayBoard();let j=D();function D(){let R=[];for(let A=0;A<8;A++)for(let I=0;I<8;I++)R.push(`${String.fromCharCode(97+I)}${8-A}`);return R}let x=[];const[C,E]=W(!1),[L,M]=W("00"),[N,F]=W("");async function O(R){F(R),E(!1);let A=a().getPieceAtBoardIndex(63-(7-parseInt(L()))),I=A.type;console.log(A),A.type=R,a().board[63-(7-parseInt(L()))]=R,a().fen=a().boardToFen(),console.log(A);let ee=document.getElementById(A.position.position)?.children[0];console.log("previous type:"+I),ee?.classList.remove(I),ee?.classList.add(R),await se(10),n()}function se(R){return new Promise(A=>setTimeout(A,R))}return[G(De,{get when(){return w()},get children(){return G(po,{opponent:b,color:"white",board:a})}}),(()=>{const R=ol.cloneNode(!0);return Ae(R,G(ao,{get children(){return[G(De,{get when(){return C()},get children(){const A=sl.cloneNode(!0),I=A.firstChild,ee=I.nextSibling,pe=ee.nextSibling,q=pe.nextSibling;return I.$$click=()=>O("q"),ee.$$click=()=>O("n"),pe.$$click=()=>O("r"),q.$$click=()=>O("b"),dt(()=>rn(A,`chessInlay ml-[${7-parseInt(L())}]`)),A}}),G($n,{get each(){return a().board},children:(A,I)=>G(co,{get style(){return I()},get pieceClassName(){return a().board[a().board.length-1-I()]},get className(){return`chessSquare ${(a().board.length-1-I())%16<8?(a().board.length-1-I())%2==0?"lighterBackground":"":(a().board.length-1-I())%2==0?"":"lighterBackground"}`},get id(){return j[a().board.length-1-I()]},board:a,updateBoard:n,get draggableId(){return al()},eatenPieces:x,setDisplayInlay:E,setDisplayInlayX:M,inlaySelection:N,displayInlay:C,color:"black",setLastMove:t,lastMove:s,movePieceSound:r,capturePieceSound:i,setMoves:p,moves:c})})]}})),R})(),G(De,{get when(){return w()},get children(){return G(fo,{user:u,color:"black",board:a,moves:c})}})]}function al(){return Math.random().toString(36).substr(2,9)}Nt(["click"]);const cl=ke(`<div class="glassOverlay"><label for="username">Choose your username</label><div class="userNameInput"><input type="username" placeholder="username" id="userNameInput"></div><button class="submitUsernameButton">LET'S GO<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 arrow"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"></path></svg></button></div>`),dl=({user:a,setUser:n,setInSession:t,chessWebSocket:s})=>{let r="";const[i,p]=W(""),c=async()=>{if(r===""){alert("Please enter a username");return}if(r.length>10&&(r=r.slice(0,10)),r===a()?.username){let w=new on(Gs(),r,i());sessionStorage.setItem("gabrielmalek/chess.data",JSON.stringify({id:w.id,username:w.username,CatUrl:w.CatUrl})),localStorage.setItem("gabrielmalek/chess.data",JSON.stringify({id:w.id,username:w.username,CatUrl:w.CatUrl})),n(w),t(!0),s.beginPinging(a);return}let b=new on(Gs(),r,i());n(b),console.log(),s.beginPinging(a),console.log(b,b.id),s.pingWebSocket(b),sessionStorage.setItem("gabrielmalek/chess.data",JSON.stringify({id:b.id,username:b.username,CatUrl:b.CatUrl})),localStorage.setItem("gabrielmalek/chess.data",JSON.stringify({id:b.id,username:b.username,CatUrl:b.CatUrl})),t(!0)};async function u(){return(await(await fetch("https://api.thecatapi.com/v1/images/search")).json())[0].url}return We(()=>{document.addEventListener("keyup",function(w){w.key==="Enter"&&c()});let b=document.getElementById("userNameInput");b?.focus(),console.log(a()?.username),a()?.username!==void 0&&(b.value=a()?.username,r=b.value),u().then(w=>{p(w)})}),(()=>{const b=cl.cloneNode(!0),w=b.firstChild,j=w.nextSibling,D=j.firstChild,x=j.nextSibling;return D.$$keyup=C=>r=C.currentTarget.value,x.$$click=()=>c(),b})()};function Gs(){let a="";for(let n=0;n<20;n++)a+=Math.floor(Math.random()*10);return a}Nt(["keyup","click"]);const ul=ke('<div class="bellContainer"><div class="dropdown"><button class="bellIcon" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="dropdownMenuButton"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0M3.124 7.5A8.969 8.969 0 015.292 3m13.416 0a8.969 8.969 0 012.168 4.5"></path></svg></button><div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div></div></div>');function hl({onClick:a,notifications:n}){return a=()=>{console.log("bell clicked"),console.log(n());let t=document.querySelector(".dropdown-menu");console.log(t),t.style.display=="block"?t.style.display="none":t.style.display="block",t.innerHTML="";for(let s=0;s<n().length;s++){let r=document.createElement("div"),i=document.createElement("div"),p=document.createElement("div");p.classList.add("username"),p.innerText=n()[s].from.username,r.classList.add("dropdown-item"),r.id=n()[s].from.id,i.classList.add("text"),i.classList.add("notificationText"),i.appendChild(p),i.innerHTML="\u{1F514}&nbsp"+i.innerHTML+"&nbsp wants to play ",r.appendChild(i),t.appendChild(r),console.log(r,"hi")}},We(()=>{document.addEventListener("click",function(t){let s=document.querySelector(".dropdown-menu"),r=document.querySelector(".bellIcon"),i=t.target;do{if(i==r)return;i=i.parentNode}while(i);s.style.display="none"})}),(()=>{const t=ul.cloneNode(!0),s=t.firstChild,r=s.firstChild;return Lr(r,"click",a,!0),t})()}Nt(["click"]);const fl=ke('<div class="glassOverlay"><ul class="list"><li class="listItem" id="mainUser"><div class="text"></div></li></ul></div>'),pl=ke('<div class="absolute left-3 text-red-500">Notification sent!</div>'),gl=ke('<div class="modal fade " id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog absolute top-[39vh] left-1/ "><div class="modal-content w-[50px] "><div class="modal-header"><h1 class="modal-title fs-5" id="exampleModalLabel">Play Chess with </h1><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body">Play online with this player right now!</div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button type="button" class="btn btn-primary">Play Chess</button></div></div></div></div>'),ml=ke('<li class="listItem" data-bs-toggle="modal" data-bs-target="#exampleModal"><div class="text"></div></li>');function vl({users:a,user:n,setNotificationUser:t,onNotificationReceived:s,chessWebSocket:r}){const[i,p]=W(),[c,u]=W(!1),[b,w]=W([]),[j,D]=W([]),[x,C]=W(!1);We(()=>{document.addEventListener("notification",M=>{console.log("notification event received");const N=JSON.parse(M.data);if(s(N),N.type!="promptForGame")return;t(N.from),console.log("notification received:",N);for(let O=0;O<b().length;O++)if(b()[O].from.id==N.from.id)return;let F=b();F.push(N),w(F),C(!0)})});function E(M){p(M),document.getElementById("exampleModal")?.style.setProperty("display","flex")}async function L(M){for(let F=0;F<j().length;F++)if(j()[F].to.id==M.to.id)return;let N=j();N.push(M),D(N),r.sendNotification(M)}return[G(De,{get when(){return x()},get children(){return G(hl,{notifications:b,onClick:()=>{}})}}),(()=>{const M=fl.cloneNode(!0),N=M.firstChild,F=N.firstChild,O=F.firstChild;return Ae(O,()=>n().username),Ae(F,G(Rn,{get catLink(){return n().CatUrl}}),null),Ae(N,G($n,{get each(){return a()},children:se=>(()=>{const R=ml.cloneNode(!0),A=R.firstChild;return R.$$click=()=>E(se),Ae(A,()=>se.username),Ae(R,G(Rn,{get catLink(){return se.CatUrl}}),null),dt(()=>Nn(R,"id",se.id)),R})()}),null),M})(),(()=>{const M=gl.cloneNode(!0),N=M.firstChild,F=N.firstChild,O=F.firstChild,se=O.firstChild;se.firstChild;const R=O.nextSibling,A=R.nextSibling,I=A.firstChild,ee=I.nextSibling;return Ae(se,(()=>{const pe=tt(()=>i()!=null);return()=>pe()?`${i()?.username}`:""})(),null),Ae(A,G(De,{get when(){return c()},get children(){return pl.cloneNode(!0)}}),I),ee.$$click=()=>{let pe=new Rr(n(),i(),"promptForGame");L(pe),c()==!1&&u(!0)},M})()]}Nt(["click"]);const wl=""+new URL("capture.7158a77f.mp3",import.meta.url).href,bl=ke('<div class="canvas-container"><canvas id="canvas"></canvas></div>');function yl({}){return We(()=>{const a=document.getElementById("canvas"),n=a.getContext("2d");a.width=window.innerWidth,a.height=window.innerHeight;const t=300,s=8;let r=[8,18,51],i=[.5,1];class p{constructor(C,E,L,M,N){this.x=C,this.y=E,this.speed_x=L,this.speed_y=M,this.radius=N,this.color="rgb(255, 255, 255, .2)"}update(){this.x+=this.speed_x,this.y+=this.speed_y,(this.x+this.radius>a.width||this.x-this.radius<0)&&(this.speed_x*=-1),(this.y+this.radius>a.height||this.y-this.radius<0)&&(this.speed_y*=-1),this.handleCollisions()}handleCollisions(){for(const C of c)if(C!==this){const E=C.x-this.x,L=C.y-this.y,M=Math.sqrt(E**2+L**2);if(M<2*this.radius){const N=2*this.radius-M,F=Math.atan2(L,E);this.x-=.5*N*Math.cos(F),this.y-=.5*N*Math.sin(F);const O=Math.atan2(L,E),se=Math.atan2(this.speed_y,this.speed_x),R=Math.sqrt(this.speed_x**2+this.speed_y**2),A=Math.sqrt(C.speed_x**2+C.speed_y**2),I=(R*Math.cos(se-O)*(this.radius-C.radius)+2*C.radius*A*Math.cos(O))/(this.radius+C.radius),ee=(R*Math.sin(se-O)*(this.radius-C.radius)+2*C.radius*A*Math.sin(O))/(this.radius+C.radius),pe=(A*Math.cos(O-se)*(C.radius-this.radius)+2*this.radius*R*Math.cos(O))/(this.radius+C.radius),q=(A*Math.sin(O-se)*(C.radius-this.radius)+2*this.radius*R*Math.sin(O))/(this.radius+C.radius);this.speed_x=I,this.speed_y=ee,C.speed_x=pe,C.speed_y=q}}}draw(C){C.beginPath(),C.arc(this.x,this.y,this.radius,0,Math.PI*2),C.fillStyle=this.color,C.fill(),C.closePath()}}const c=[];for(let x=0;x<t;x++){const C=b(s,a.width-s),E=b(s,a.height-s),L=w(...i)*j(),M=w(...i)*j(),N=new p(C,E,L,M,s);c.push(N)}function u(){requestAnimationFrame(u),n.fillStyle=`rgb(${r[0]}, ${r[1]}, ${r[2]})`,n.fillRect(0,0,a.width,a.height);for(const x of c)x.update(),x.draw(n)}u();function b(x,C){return Math.floor(Math.random()*(C-x+1))+x}function w(x,C){return Math.random()*(C-x)+x}function j(){return Math.random()<.5?-1:1}window.addEventListener("resize",()=>{console.log("resize");let x=window.innerWidth,C=window.innerHeight;a.width=x,a.height=C;for(const E of c)E.x=D(E.x,x,E.radius),E.y=D(E.y,C,E.radius)});function D(x,C,E){return Math.min(Math.max(x,E),C-E)}}),bl.cloneNode(!0)}class _l{url="wss://gabrielmalek.com/v1/api/chessSub";ws;setWS;pingsSinceResponse=0;board;setBoard;setUser;user;pings=0;crownedIndex=-1;moves;setMoves;constructor(n,t,s,r,i,p){this.board=n,this.setBoard=t,this.setUser=r,this.user=s;let[c,u]=W(this.createWS(this.url));this.ws=c,console.log("ws",this.ws()),this.setWS=u,this.createListeners(),this.moves=i,this.setMoves=p}sendChessUpdate(n,t,s,r){console.log("sending chess update",r);let i=new Fr(n.fen,t,s,n.currentTurnColor,r);this.ws().send(JSON.stringify(i))}unloadWebSockets(){window.onbeforeunload=()=>{this.ws().close()}}createWS(n){return new WebSocket(n)}pingWebSocket(n){if(this.ws().readyState!=3&&this.ws().readyState===1){if(this.pings<-10&&(this.pings=0),this.pings>5){this.ws().close(),this.pings=0;return}this.pings++,this.ws().send(JSON.stringify(n))}}beginPinging(n){setInterval(()=>{this.pingWebSocket(n())},3e3)}reconnectWebSocket(){this.setWS(this.createWS(this.url)),this.createListeners()}createListeners(){this.ws().addEventListener("open",()=>{console.log("ws open")}),this.ws().addEventListener("close",()=>{console.log("ws closed"),this.reconnectWebSocket()}),this.ws().addEventListener("message",async n=>{this.pings--;let t=JSON.parse(n.data);if(t.users){this.pingsSinceResponse--;let s=new CustomEvent("usersUpdated");s.data=t.users,document.dispatchEvent(s)}if(t.type==="promptForGame"||t.type=="createGame"){let s=new CustomEvent("notification");s.data=t,document.dispatchEvent(s)}if(t.type==="chessGameUpdate"&&(await this.sleep(100),console.log("chess game update",t),t.fen!=this.board().fen)){console.log(t.fen,"vs",this.board().fen);let s=new ce(void 0,t.fen);console.log("new board",s),this.board().fen=t.fen,this.board().board=s.board,this.board().currentTurnColor=s.currentTurnColor,this.board().capturedPieces=s.capturedPieces,this.board().Pieces=s.Pieces,this.board().checkMate=s.checkMate,this.board().enPassantTargetSquare=s.enPassantTargetSquare,this.board().halfMoveClock=s.halfMoveClock,this.board().fullMoveNumber=s.fullMoveNumber,this.board().inCheck=s.inCheck,this.board().legalMoves=s.legalMoves,this.mergeMoves(t.moves);let r=this.moves()[this.moves().length-1],i=document.querySelectorAll(".chessSquare");for(let u=0;u<i.length;u++)i[u].id===r.from||i[u].id===r.to?i[u]?.classList?.add("lastMove"):i[u]?.classList?.remove("lastMove");let p=new CustomEvent("forceBoardUpdate");if(document.dispatchEvent(p),this.pawnsAtEndOfBoard()){let u=new CustomEvent("crowned");u.data=s,document.dispatchEvent(u)}}})}mergeMoves(n){let t=[...this.moves()];for(let s=0;s<n.length;s++){let r=!1;for(let i=0;i<this.moves().length;i++)if(n[s].from===this.moves()[i].from&&n[s].to===this.moves()[i].to){r=!0;break}r||t.push(n[s])}console.log("new moves",t),console.log(t.length,"vs",this.moves().length,"vs",n.length),this.setMoves(t)}async sleep(n){return new Promise(t=>setTimeout(t,n))}sendNotification(n){this.ws().send(JSON.stringify(n))}pawnsAtEndOfBoard(){let n=[],t=[];for(let s=0;s<8;s++)this.board().board[s]==="P"&&(n.push(this.board().board[s]),this.crownedIndex=s);for(let s=56;s<64;s++)this.board().board[s]==="p"&&(t.push(this.board().board[s]),this.crownedIndex=s);return n.length>0||t.length>0}close(){this.ws().close()}generateUserid(){let n="";for(let t=0;t<20;t++)n+=Math.floor(Math.random()*10);return n}}class Ys{ws;initialized=!1;virtualCursor;self;opponent;constructor(n,t,s){this.ws=n,this.virtualCursor=this.createVirtualCursor(),this.self=t,this.opponent=s}init(){this.initialized=!0,this.catchWedSocketEvents(),this.sendMouseEvents()}catchWedSocketEvents(){this.ws().addEventListener("message",n=>{if(JSON.parse(n.data).type!="virtualMouseEvent")return;let s=JSON.parse(n.data);this.triggerVirtualMouseEvent(s)}),this.ws().addEventListener("close",async()=>{await this.sleep(1e3),this.catchWedSocketEvents()})}triggerVirtualMouseEvent(n){let t,s,r,i;switch(n.eventType){case"pointermove":s=this.setVirtualPosition(n),t=new Event("virtualpointermove"),t.clientX=s.x,t.clientY=s.y,document.dispatchEvent(t);break;case"pointerdown":if(s=this.setVirtualPosition(n),r=document.elementsFromPoint(s.x,s.y),i=r[1],i.classList.contains("canDrag"))return;t=new Event("virtualpointerdown"),t.clientX=s.x,t.clientY=s.y,i.dispatchEvent(t),document.dispatchEvent(t),this.virtualCursor.style.backgroundColor="rgba(255, 0, 0, 0.541)";break;case"pointerup":t=new Event("virtualpointerup"),document.dispatchEvent(t),this.virtualCursor.style.backgroundColor="rgba(255, 0, 0, 0)";break}}sendMouseEvents(){let n=document.querySelector(".chessBoard");document.addEventListener("pointermove",t=>{if(!this.initialized)return;let s=n?.offsetWidth,r=new Vn(t.clientX,t.clientY),i=new fi(this.self,this.opponent,r,s,"pointermove");this.ws().send(JSON.stringify(i))}),document.addEventListener("pointerdown",t=>{let s=n?.offsetWidth,r=new Vn(t.clientX,t.clientY),i=new fi(this.self,this.opponent,r,s,"pointerdown");this.ws().send(JSON.stringify(i))}),document.addEventListener("pointerup",t=>{let s=n?.offsetWidth,r=new Vn(t.clientX,t.clientY),i=new fi(this.self,this.opponent,r,s,"pointerup");this.ws().send(JSON.stringify(i))})}setVirtualPosition(n){let t=document.querySelector(".oponentsCursor"),s=window.innerWidth,r=window.innerHeight,i=n.position.x,p=n.position.y,c=n.screen.x/2,u=n.screen.y/2,b=i-c,w=p-u,j=s/2,D=r/2,x=document.querySelector(".chessBoard").offsetWidth,C=x,E=x/n.chessBoardWidth,L=C/n.chessBoardWidth,M=b*E,N=w*L;j=window.innerWidth/2,D=window.innerHeight/2;let F=j-M,O=D-N;return t.style.transform=`translate(${F-this.cursorWidth/2}px, ${O-this.cursorWidth/2}px)`,{x:F,y:O}}createVirtualCursor(){let n=document.createElement("div");return n.classList.add("oponentsCursor"),document.body.appendChild(n),this.cursorWidth=n.offsetHeight,n}async sleep(n){return new Promise(t=>setTimeout(t,n))}}const Pl=ke('<div id="notificationButton" data-bs-toggle="modal" data-bs-target="#notificationModal"></div>'),xl=ke(`<div class="modal fade " id="notificationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog absolute top-[39vh] left-1/ "><div class="modal-content w-[50px] "><div class="modal-header"><h1 class="modal-title fs-5" id="exampleModalLabel">Play Chess with "<!>"</h1><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body">You've recieved a notification from "<!>" to play chess. Do you accept?</div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button type="button" class="btn btn-primary">Play Chess</button></div></div></div></div>`);function Al({}){const a=new Audio(ho),n=new Audio(wl),[t,s]=W(new ce),[r,i]=W(!1),[p,c]=W("");W([]);const[u,b]=W();W(!1);const[w,j]=W([]),[D,x]=W(),[C,E]=W(),[L,M]=W([]),[N,F]=W(!1),[O,se]=W(),[R,A]=W(null),I=new _l(t,s,D,x,w,j);Js(()=>{I.ws()&&I.close()}),We(async()=>{window.users=L,Ve(),ee(),document.addEventListener("mousedown",_=>q(_)),document.ws=I.ws()});function ee(){document.addEventListener("usersUpdated",_=>{let g=_.data.filter(le=>D().id!=le.id);M([...g])}),document.addEventListener("notification",_=>{ue(_.data)}),document.addEventListener("updateUser",_=>{let g=document.querySelector("#mainUser");g.querySelector(".catLogo").style.backgroundImage="nothing"}),document.addEventListener("updateBoard",_=>{He(_.data)}),document.addEventListener("crowned",_=>{console.log("listened to crowned event"),pe(_.data)}),document.addEventListener("forceBoardUpdate",_=>{de(),a.play()})}function pe(_){console.log("crowned event received",_);let g=I.crownedIndex;console.log("crowned index",g);let le=t().getPieceAtBoardIndex(g);console.log("crowned pawn",le);let Y=le.type;console.log("previous type",Y);let H=_.board[g];console.log("new piece type",H);let oe=H.toLowerCase();le.type=oe,t().board[g]=H;let ge=document.getElementById(le.position.position)?.children[0];ge?.classList.remove(Y),ge?.classList.add(H),de()}function q(_){_.detail>1&&_.preventDefault()}async function Ve(){let _=sessionStorage.getItem("gabrielmalek/chess.data"),g=JSON.parse(_);if(_==null)console.log("session storage null");else{console.log("session storage not null");let le=new on(g.id,g.username,g.CatUrl);x(le),F(!0),I.beginPinging(D),console.log("should be pinging");return}if(_=localStorage.getItem("gabrielmalek/chess.data"),g=JSON.parse(_),_==null)console.log("local storage null");else{let le=new on(g.id,g.username,g.CatUrl);if(le.username==""||le.username==null)return;x(le),F(!1)}}async function de(){let _=document.querySelectorAll(".chessSquare"),g=document.querySelectorAll("section.piece");if(p()=="white"){for(let H=0;H<g.length;H++)g[H].remove();let Y=[];for(let H=0;H<t().board.length;H++)if(t().board[H]!=" "){for(let oe=0;oe<g.length;oe++)if(g[oe].classList.contains(t().board[H])&&!Y.includes(oe)){_[H].appendChild(g[oe]),Y.push(oe);break}}for(let H=0;H<t().board.length;H++){let oe=_[H]?.querySelector(".piece");if(oe!=null&&t().board[H]!=" "){if(!oe.classList.contains(t().board[H])){console.log("something is funky"),console.log("piece",oe),console.log("board",t().board[H]);break}}else if(oe==null&&t().board[H]!=" "){console.log("something is funky"),console.log("piece",oe),console.log("board",t().board[H]);for(let ge=0;ge<g.length;ge++)if((g[ge].classList.contains("p")||g[ge].classList.contains("P"))&&!Y.includes(ge)){console.log("found piece",g[ge]);let me=g[ge];me.classList.contains("p")?(me.classList.remove("p"),me.classList.add(t().board[H])):(me.classList.remove("P"),me.classList.add(t().board[H])),_[H].appendChild(me)}break}}}else if(p()=="black"){for(let oe=0;oe<g.length;oe++)g[oe].remove();let Y=[],H=0;for(let oe=t().board.length-1;oe>=0;oe--){if(t().board[oe]!=" "){for(let ge=0;ge<g.length;ge++)if(g[ge].classList.contains(t().board[oe])&&!Y.includes(ge)){_[H].appendChild(g[ge]),Y.push(ge);break}}H++}H=0;for(let oe=t().board.length-1;oe>=0;oe--){let ge=_[H]?.querySelector(".piece");if(ge!=null&&t().board[oe]!=" "){if(!ge.classList.contains(t().board[oe]))break}else if(ge==null&&t().board[oe]!=" "){for(let me=0;me<g.length;me++)if((g[me].classList.contains("p")||g[me].classList.contains("P"))&&!Y.includes(me)){let Le=g[me];Le.classList.contains("p")?(Le.classList.remove("p"),Le.classList.add(t().board[oe])):(Le.classList.remove("P"),Le.classList.add(t().board[oe])),_[H].appendChild(Le)}break}H++}}t().displayBoard(),console.log("moves",w());let le=new Event("boardUpdated");document.dispatchEvent(le),Ce()}function Ce(){t().findLegalMoves(t());let _=t().isInCheck(t()),g=document.querySelector(".checked");if(g?.classList.remove("checked"),_){for(let le=0;le<t().Pieces.length;le++)if(t().Pieces[le].type=="k"&&t().Pieces[le].color==t().currentTurnColor){console.log("made it here");let Y=t().Pieces[le];console.log("king",Y),console.log("king position",Y.getPosition());let H=document.getElementById(Y.getPosition());console.log("UIKingSquare",H),H?.classList.add("checked")}}}async function He(_){if(_===void 0){console.log("DATA",_),await de(),I.sendChessUpdate(t(),D(),C(),w());return}}function ue(_){A(_),_.type=="promptForGame"?(A(_),document.querySelector("#notificationButton").click()):_.type=="createGame"?(A(_),c(_.fromUserColor),E(_.to),i(!0),new Ys(I.ws,D(),_.to).init(),he()):_.type=="position"}async function Z(_){console.log("we must create a game");let g=new qr(_.from,_.to);try{I.ws().send(JSON.stringify(g)),c(g.fromUserColor==="white"?"black":"white"),console.log("oppoent",_.from);let le=new on(_.from.id,_.from.username,_.from.CatUrl);E(_.from),i(!0),new Ys(I.ws,D(),_.from).init(),he()}catch(le){console.log("error: ",le)}}function he(){let _=document.querySelector(".modal-backdrop ");_?.remove()}return[G(yl,{}),G(De,{get when(){return tt(()=>!N())()&&r()==!1},get children(){return G(dl,{user:D,setUser:x,setInSession:F,chessWebSocket:I})}}),G(De,{get when(){return tt(()=>!!N())()&&r()==!1},get children(){return G(vl,{users:L,user:D,setNotificationUser:se,onNotificationReceived:ue,chessWebSocket:I})}}),G(De,{get when(){return tt(()=>p()=="white")()&&r()==!0},get children(){return G(nl,{board:t,updateBoard:He,setLastMove:b,lastMove:u,movePieceSound:a,capturePieceSound:n,setMoves:j,moves:w,user:D,opponent:C,inGame:r})}}),G(De,{get when(){return r()==!1||p()=="black"&&r()==!0},get children(){return G(ll,{board:t,updateBlackBoard:He,setLastMove:b,lastMove:u,movePieceSound:a,capturePieceSound:n,setMoves:j,moves:w,user:D,opponent:C,inGame:r})}}),G(De,{get when(){return r()==!1},get children(){return[Pl.cloneNode(!0),(()=>{const _=xl.cloneNode(!0),g=_.firstChild,le=g.firstChild,Y=le.firstChild,H=Y.firstChild,oe=H.firstChild,ge=oe.nextSibling;ge.nextSibling;const me=Y.nextSibling,Le=me.firstChild,Oe=Le.nextSibling;Oe.nextSibling;const ut=me.nextSibling,st=ut.firstChild,kt=st.nextSibling;return _.style.setProperty("display","none"),Ae(H,()=>O()?.username,ge),Ae(me,()=>O()?.username,Oe),kt.$$click=()=>{Z(R())},_})()]}})]}Nt(["click"]);const Cl=()=>G(Al,{});Br(()=>G(Cl,{}),document.getElementById("root"));
